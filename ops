{"version":1,"ops":[{"type":3,"author":{"id":"7c3935464acdaaae9d6fcb27abcbbe21ec75027f"},"timestamp":1555593211,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQ4NDUwMjExMw==","github-url":"https://github.com/DFHack/df-structures/issues/321#issuecomment-484502113"},"message":"What matters is which integer type is used most. If part_of_speech is usually an int32_t, it should be based on that.\n\nWhat exactly do you mean by getting incorrect values? The array here should be int16_ts in all languages, so I don't see how you could read from it incorrectly unless you were doing weird stuff with casting.","files":null},{"type":3,"author":{"id":"c49d776d8bb9c3344c0c6571e15cc127015e3e6c"},"timestamp":1555604290,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQ4NDU3OTA5MA==","github-url":"https://github.com/DFHack/df-structures/issues/321#issuecomment-484579090"},"message":"I don't get the point of having an enum defined as an int32_t (4 bytes) and used later as one int16_t.\n\nThe incorrect values I get is because in one parts_of_speech array that I'm processing I use  int32_t as the base type instead of an int16_t, and adding sizeof(int32_t) for the address of the next array element when it should be sizeof(int16_t). That's why I get wrong values. \n\nFor part_of_speech, is defined as one int32_t and used as int16_t and int32_t\n\nSame for world_population_type,  defined as int32_t and used as int8_t and int16_t","files":null},{"type":3,"author":{"id":"7c3935464acdaaae9d6fcb27abcbbe21ec75027f"},"timestamp":1555642910,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQ4NDc1Mjg0MA==","github-url":"https://github.com/DFHack/df-structures/issues/321#issuecomment-484752840"},"message":"All the occurrences I could find:\n```\ndf.creature-raws.xml:        \u003cenum base-type='int16_t' type-name='part_of_speech'\ndf.language.xml:            \u003cenum base-type='int16_t' type-name='part_of_speech'/\u003e\ndf.language.xml:                \u003cenum base-type='int32_t' type-name='part_of_speech'/\u003e\ndf.viewscreen.xml:            \u003cenum base-type='int32_t' type-name='part_of_speech'/\u003e\n```\nThis is a mix of types. We can't control the types of these, or the fact that they are part_of_speech instances. I don't know how exactly Toady does this in his code, but we can't make part_of_speech inherit from both int16_t and int32_t. Since int32_t is the \"default\" for our purposes, I'd say that's reasonable.","files":null},{"type":3,"author":{"id":"c49d776d8bb9c3344c0c6571e15cc127015e3e6c"},"timestamp":1555657908,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQ4NDc4ODQ1Mw==","github-url":"https://github.com/DFHack/df-structures/issues/321#issuecomment-484788453"},"message":"I need then to consider the size of the enum in every place where is referenced and not the one provided in the enum definition. That complicates the parsing.","files":null},{"type":4,"author":{"id":"c49d776d8bb9c3344c0c6571e15cc127015e3e6c"},"timestamp":1555657908,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MjI4NzU4MzAzOA=="},"status":2},{"type":3,"author":{"id":"7c3935464acdaaae9d6fcb27abcbbe21ec75027f"},"timestamp":1555696658,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDQ4NDk3MTU2OA==","github-url":"https://github.com/DFHack/df-structures/issues/321#issuecomment-484971568"},"message":"Yup, sorry. Not sure why DF does things like this sometimes, but it makes things complicated.","files":null}]}