<data-definition>
    <enum-type type-name='embark_finder_option' base-type='int16_t'> bay12: FindSiteParamType
        <enum-item name='DimensionX'/>
        <enum-item name='DimensionY'/>
        <enum-item name='Savagery'/>
        <enum-item name='Spirit'/>
        <enum-item name='Elevation'/>
        <enum-item name='Temperature'/>
        <enum-item name='Rain'/>
        <enum-item name='Drainage'/>
        <enum-item name='FluxStone'/>
        <enum-item name='AquiferLight'/>
        <enum-item name='AquiferHeavy'/>
        <enum-item name='River'/>
        <enum-item name='UndergroundRiver'/>
        <enum-item name='UndergroundPool'/>
        <enum-item name='MagmaPool'/>
        <enum-item name='MagmaPipe'/>
        <enum-item name='Chasm'/>
        <enum-item name='BottomlessPit'/>
        <enum-item name='OtherFeatures'/>
        <enum-item name='Soil'/>
        <enum-item name='Clay'/>
        <enum-item name='Sand'/>
    </enum-type>

    -- Unused: HF_DUEL_FLAG_*
    -- Unused: HFDuelType
    -- Unused: SITUATION_COMBAT_RESULT_FLAG_*
    -- Unused: situation_combatst
    -- Unused: SituationInfiltrationChoiceType
    -- Unused: SituationInfiltrationType
    -- Unused: SITUATION_INFILTRATION_FLAG_*
    -- Unused: situation_infiltrationst

    <struct-type type-name='worldgen_parms_ps' original-name='world_gen_param_presetst'>
        <int32_t name='width'/>
        <int32_t name='height'/>
        <static-array count='24' name='data' index-enum='worldgen_range_type'>
            <pointer is-array='true'><pointer is-array='true' type-name='int16_t'/></pointer>
        </static-array>
    </struct-type>

    <struct-type type-name='worldgen_parms' original-name='world_gen_paramst'>
        <stl-string name='title'/>
        <stl-string name='seed' since='v0.34.01'/>
        <stl-string name='history_seed' since='v0.34.01'/>
        <stl-string name='name_seed' since='v0.34.01'/>
        <stl-string name='creature_seed' since='v0.34.01'/>
        <int32_t name='dim_x'/>
        <int32_t name='dim_y'/>
        <stl-string name='custom_name'/>
        <bool name='has_seed'/>
        <bool name='has_history_seed'/>
        <bool name='has_name_seed'/>
        <bool name='has_creature_seed'/>
        <int32_t name='embark_points'/>
        <int32_t name='peak_number_min'/>
        <int32_t name='partial_ocean_edge_min'/>
        <int32_t name='complete_ocean_edge_min'/>
        <int32_t name='volcano_min'/>
        <static-array name='region_counts' count='3'>
            <static-array type-name='int32_t' count='10' index-enum='world_region_type'/>
        </static-array>
        <static-array type-name='int32_t' name='river_mins' count='2'/>
        <int32_t name='subregion_max'/>
        <int32_t name='cavern_layer_count'/>
        <int32_t name='cavern_layer_openness_min'/>
        <int32_t name='cavern_layer_openness_max'/>
        <int32_t name='cavern_layer_passage_density_min'/>
        <int32_t name='cavern_layer_passage_density_max'/>
        <int32_t name='cavern_layer_water_min'/>
        <int32_t name='cavern_layer_water_max'/>
        <bool name='have_bottom_layer_1'/>
        <bool name='have_bottom_layer_2'/>
        <int32_t name='levels_above_ground'/>
        <int32_t name='levels_above_layer_1'/>
        <int32_t name='levels_above_layer_2'/>
        <int32_t name='levels_above_layer_3'/>
        <int32_t name='levels_above_layer_4'/>
        <int32_t name='levels_above_layer_5'/>
        <int32_t name='levels_at_bottom'/>
        <int32_t name='cave_min_size'/>
        <int32_t name='cave_max_size'/>
        <int32_t name='mountain_cave_min'/>
        <int32_t name='non_mountain_cave_min'/>
        <int32_t name='mythical_site_num'/>
        <int32_t name='total_civ_number'/>
        <int32_t name='rain_ranges_1'/>
        <int32_t name='rain_ranges_0'/>
        <int32_t name='rain_ranges_2'/>
        <int32_t name='drainage_ranges_1'/>
        <int32_t name='drainage_ranges_0'/>
        <int32_t name='drainage_ranges_2'/>
        <int32_t name='savagery_ranges_1'/>
        <int32_t name='savagery_ranges_0'/>
        <int32_t name='savagery_ranges_2'/>
        <int32_t name='volcanism_ranges_1'/>
        <int32_t name='volcanism_ranges_0'/>
        <int32_t name='volcanism_ranges_2'/>
        <static-array count='4' name='ranges'>
            <static-array type-name='int32_t' count='24' index-enum='worldgen_range_type'/>
        </static-array>
        <int32_t name='beast_end_year'/>
        <int32_t name='end_year'/>
        <int32_t name='beast_end_year_percent'/>
        <int32_t name='total_civ_population'/>
        <int32_t name='site_cap'/>
        <int32_t name='elevation_ranges_1'/>
        <int32_t name='elevation_ranges_0'/>
        <int32_t name='elevation_ranges_2'/>
        <int32_t name='mineral_scarcity'/>
        <int32_t name='megabeast_cap'/>
        <int32_t name='semimegabeast_cap'/>
        <int32_t name='titan_number'/>
        <static-array type-name='int32_t' name='titan_attack_trigger' count='3'/>
        <int32_t name='demon_number'/>
        <int32_t name='night_troll_number'/>
        <int32_t name='bogeyman_number'/>
        <int32_t name='nightmare_number' since='v0.47.01'/>
        <int32_t name='vampire_number'/>
        <int32_t name='werebeast_number'/>
        <static-array type-name='int32_t' name='werebeast_attack_trigger' count='3' since='v0.47.01'/>
        <int32_t name='secret_number'/>
        <int32_t name='regional_interaction_number'/>
        <int32_t name='disturbance_interaction_number'/>
        <int32_t name='evil_cloud_number'/>
        <int32_t name='evil_rain_number'/>
        <int8_t name='generate_divine_materials' since='v0.40.01'/>
        <int8_t name='use_mythical_materials' since='v0.51.01'/>
        <int8_t name='allow_mythical_healing' since='v0.51.01'/>
        <int8_t name='allow_divination' since='v0.47.01'/>
        <int8_t name='allow_demonic_experiments' since='v0.47.01'/>
        <int8_t name='allow_necromancer_experiments' since='v0.47.01'/>
        <int8_t name='allow_necromancer_lieutenants' since='v0.47.01'/>
        <int8_t name='allow_necromancer_ghouls' since='v0.47.01'/>
        <int8_t name='allow_necromancer_summons' since='v0.47.01'/>
        <int32_t name='good_sq_counts_0'/>
        <int32_t name='evil_sq_counts_0'/>
        <int32_t name='good_sq_counts_1'/>
        <int32_t name='evil_sq_counts_1'/>
        <int32_t name='good_sq_counts_2'/>
        <int32_t name='evil_sq_counts_2'/>
        <static-array type-name='int32_t' name='elevation_frequency' count='6'/>
        <static-array type-name='int32_t' name='rain_frequency' count='6'/>
        <static-array type-name='int32_t' name='drainage_frequency' count='6'/>
        <static-array type-name='int32_t' name='savagery_frequency' count='6'/>
        <static-array type-name='int32_t' name='temperature_frequency' count='6'/>
        <static-array type-name='int32_t' name='volcanism_frequency' count='6'/>
        <pointer type-name='worldgen_parms_ps' name='ps'/>
        <int32_t name='reveal_all_history'/>
        <int32_t name='cull_historical_figures'/>
        <int32_t name='erosion_cycle_count'/>
        <int32_t name='periodically_erode_extremes'/>
        <int32_t name='orographic_precipitation'/>
        <int32_t name='playable_civilization_required'/>
        <int32_t name='all_caves_visible'/>
        <int32_t name='show_embark_tunnel'/>
        <int32_t name='pole'/>
        <bool name='immune_to_resize'/>
    </struct-type>

    <enum-type type-name='region_permission_type'> bay12: RegionPermission
        <enum-item name='ADVENTURE_MAIN'/>
        <enum-item name='UNUSED11'/> used as index-enum, so name all entries
        <enum-item name='UNUSED12'/>
        <enum-item name='DWARF_MAIN'/>
        <enum-item name='UNUSED0'/>
        <enum-item name='UNUSED1'/>
        <enum-item name='UNUSED2'/>
        <enum-item name='UNUSED3'/>
        <enum-item name='UNUSED4'/>
        <enum-item name='UNUSED5'/>
        <enum-item name='UNUSED6'/>
        <enum-item name='UNUSED7'/>
        <enum-item name='UNUSED8'/>
        <enum-item name='UNUSED9'/>
        <enum-item name='UNUSED10'/>
    </enum-type>

    <enum-type type-name='pole_type' base-type='int16_t'> bay12: PoleType, actual base int32_t never used
        <enum-item name='None' value='-1'/>
        <enum-item name='North'/>
        <enum-item name='South'/>
        <enum-item name='Both'/>
    </enum-type>

    <enum-type type-name='sunrise_type' base-type='int16_t'> bay12: SunriseType, actual base int32_t never used
        <enum-item name='None' value='-1'/>
        <enum-item name='East'/>
        <enum-item name='West'/>
    </enum-type>

    <enum-type type-name='region_map_entry_flags'> bay12: RegionSquareFlagType
        <enum-item name='has_river'/>
        <enum-item comment='unused_02'/>
        <enum-item name='new_lake'/>
        <enum-item name='has_site'/>
        <enum-item name='temp_river'/>
        <enum-item name='river_up'/>
        <enum-item name='river_down'/>
        <enum-item name='river_right'/>

        <enum-item name='river_left'/>
        <enum-item name='discovered'/>
        <enum-item name='light'/>
        <enum-item name='skylight'/>
        <enum-item name='has_army'/>
        <enum-item name='is_peak'/>
        <enum-item name='is_lake'/>
        <enum-item name='is_brook'/>

        <enum-item name='has_road' comment='any construction'/>
        <enum-item name='orig_river_source'/>
    </enum-type>

    <bitfield-type type-name='region_weather_flag' base-type='uint16_t'> bay12: REGION_WEATHER_*
        <flag-bit name='front' count='2' type-name='front_type'/>
        <flag-bit name='cumulus' count='2' type-name='cumulus_type'/>
        <flag-bit name='cirrus' count='1'/>
        <flag-bit name='stratus' count='2' type-name='stratus_type'/>
        <flag-bit name='fog' count='2' type-name='fog_type'/>
        <flag-bit name='countdown' count='4' comment='A counter for stratus clouds that randomly decreases by 1 or 0 each timer weather is checked there. it does various stratus/fog effects based on the humidity/breezes/etc.'/>
    </bitfield-type>

    <enum-type type-name='front_type' base-type='uint16_t'> bay12: REGION_WEATHER_FRONT_*
        <enum-item name='front_none'/>
        <enum-item name='front_warm'/>
        <enum-item name='front_cold'/>
        <enum-item name='front_occluded'/>
    </enum-type>

    <enum-type type-name='cumulus_type' base-type='uint16_t'> bay12: REGION_WEATHER_CUMULUS_*
        <enum-item name='cumulus_none'/>
        <enum-item name='cumulus_medium'/>
        <enum-item name='cumulus_multi'/>
        <enum-item name='cumulus_nimbus'/>
    </enum-type>

    <enum-type type-name='stratus_type' base-type='uint16_t'> bay12: REGION_WEATHER_STRATUS_*
        <enum-item name='stratus_none'/>
        <enum-item name='stratus_alto'/>
        <enum-item name='stratus_proper'/>
        <enum-item name='stratus_nimbus'/>
    </enum-type>

    <enum-type type-name='fog_type' base-type='uint16_t'> bay12: REGION_WEATHER_FOG_*
        <enum-item name='fog_none'/>
        <enum-item name='fog_mist'/>
        <enum-item name='fog_normal'/>
        <enum-item name='fog_thick'/>
    </enum-type>

    <bitfield-type type-name='region_daily_winds' base-type='uint16_t' comment='blows toward direction in morning'> bay12: REGION_DAILY_WINDS_*
        <flag-bit name='north_1'/> land_sea
        <flag-bit name='south_1'/>
        <flag-bit name='east_1'/>
        <flag-bit name='west_1'/>
        <flag-bit name='north_2'/> mount_valley
        <flag-bit name='south_2'/>
        <flag-bit name='east_2'/>
        <flag-bit name='west_2'/>
    </bitfield-type>

    <struct-type type-name='region_map_entry' original-name='region_squarest'>
        <int32_t name="path_map" comment='unsaved'/>
        <int32_t name="finder_rank" init-value='-1'/>
        <stl-vector name="sites" pointer-type='world_site'/>
        <df-flagarray name='flags' index-enum='region_map_entry_flags'/>

        bay12: actually an int16 array indexed by worldgen_range_type
        <int16_t name="elevation" comment='0-99=Ocean, 150+=Mountains, 100-149: all other biomes. Note that PSV elevation uses 100-299 for normal biomes, with range later cut to 1/4, and Mountains shifted down'/>
        <int16_t name="rainfall" comment='0-100'/>
        <int16_t name="vegetation" comment='0-100'/>
        <int16_t name="temperature" comment="Urists. 10000 Urists=0 Celsius. Urist steps equals Fahrenheit steps, which is equal to 5/9 Celsius steps"/>
        <int16_t name="evilness" comment='0-32=Good, 33-65=Neutral, 66-100=Evil'/>
        <int16_t name="drainage" comment='0-100'/>
        <int16_t name="volcanism" comment='0-100'/>
        <int16_t name="savagery" comment='0-32=Calm, 33-65=Neutral, 66-100=Savage'/>
        <int16_t name="air_temp"/>
        <int16_t name="air_x" comment='Toady: a velocity component?  I dont remember'/>
        <int16_t name="air_y" />
        <bitfield name='clouds' base-type='uint16_t' type-name='region_weather_flag'/>
        <bitfield name='wind' base-type='uint16_t' type-name='region_daily_winds' comment='blows toward direction in morning'/>
        <int16_t name="snowfall" comment='0-5000, humidity?'/>
        <int16_t name="salinity" comment='0-100'/>
        <int16_t name="unused_16"/>
        <int16_t name="unused_17"/>
        <int16_t name="unused_18"/>
        <int16_t name="unused_19"/>
        <int16_t name="unused_20"/>
        <int16_t name="unused_21"/>
        <int16_t name="unused_22"/>
        <int16_t name="unused_23"/>
        <int16_t name="unused_24"/>

        <int32_t name="region_id" ref-target='world_region'/>
        <int32_t name="landmass_id" ref-target='world_landmass'/>
        <int16_t name='geo_index' ref-target='world_geo_biome'/>
    </struct-type>

    <enum-type type-name='mountain_peak_flags'> bay12: PeakFlagType
        <enum-item name='is_volcano'/>
        <enum-item name='climbed'/>
    </enum-type>

    <struct-type type-name='world_mountain_peak' original-name='peakst'
                 instance-vector='$global.world.world_data.mountain_peaks'>
        <compound name='name' type-name='language_name'/>
        <compound name='pos' type-name='coord2d'/>
        <df-flagarray name='flags' index-enum='mountain_peak_flags'/>
        <int16_t name="height"/>
    </struct-type>

    <struct-type type-name='world_region' instance-vector='$global.world.world_data.regions' original-name='subregionst'>
        <compound name='name' type-name='language_name'/>
        <code-helper name='describe'>(describe-obj $.name)</code-helper>

        <int32_t name="index"/>

        <enum base-type='int16_t' name="type" type-name='world_region_type'/>

        <compound name='region_coords' type-name='coord2d_path'/>

        <int32_t name="size" comment='Number of tiles in the region'/>
        <int32_t name="savageboundnum"/>
        <int32_t name="totalboundnum"/>
        <int32_t name="origsavagenum"/>
        <int32_t name="orig_savage_total_only_high"/>

        <stl-vector name="population" pointer-type='world_population'/>

        <static-array name="biome_tile_counts" count="51" type-name='int32_t' index-enum='biome_type'/>
        <stl-vector name="tree_biomes">
            <enum base-type='int16_t' type-name='biome_type'/>
        </stl-vector>
        <stl-vector name="tree_tiles_1" index-refers-to='$$._global.tree_biomes[$].refers-to'>
            <int16_t ref-target='plant_raw' />
        </stl-vector>
        <stl-vector name="tree_tiles_2" index-refers-to='$$._global.tree_biomes[$].refers-to'>
            <int16_t ref-target='plant_raw' />
        </stl-vector>
        <stl-vector name="tree_tiles_good" index-refers-to='$$._global.tree_biomes[$].refers-to'>
            <int16_t ref-target='plant_raw' />
        </stl-vector>
        <stl-vector name="tree_tiles_evil" index-refers-to='$$._global.tree_biomes[$].refers-to'>
            <int16_t ref-target='plant_raw' />
        </stl-vector>
        <stl-vector name="tree_tiles_savage" index-refers-to='$$._global.tree_biomes[$].refers-to'>
            <int16_t ref-target='plant_raw' />
        </stl-vector>

        <int8_t name="dead_percentage" comment="% vegetation dead on embark. The number increases during world gen history, with the new ones always at 100%"/>
        <bool name="evilgood_pic" comment="Probably optionally set only on good and evil regions during world gen. Number set increases during world gen history and can affect neutral."/>
        <bool name="has_bogeymen" comment="Probably optionally set only on neutral regions"/>
        <bool name="reanimating" comment="Indicates that region interaction is reanimating"/>
        <int32_t name="last_temp_evil_year" init-value='-1' since='v0.47.01' comment="Number set increases during world gen history"/>
        <bool name='evil'/>
        <bool name='good'/>  -- At most one of 'evil' and 'good' is set at a time by DF.
        <int16_t name='lake_surface' init-value='-30000'/>
        <stl-vector name="forces" type-name='int32_t' ref-target='historical_figure' comment="historical figure IDs of force deities associated with the region. Number set increases during civ placement"/>
        <int16_t name="civs_received" init-value='0' comment="Number set increases during civ placement"/>
        <int32_t name="mid_x"/>
        <int32_t name="mid_y"/>
        <int32_t name="min_x"/>
        <int32_t name="max_x"/>
        <int32_t name="min_y"/>
        <int32_t name="max_y"/>
    </struct-type>

    <struct-type type-name='world_geo_layer' original-name='geological_layerst'>
        <enum base-type='int16_t' name="type" type-name='geo_layer_type'/>

        <int32_t name="mat_index" ref-target='inorganic_raw'/>

        <code-helper name='describe'>(describe-obj $.mat_index.ref-target)</code-helper>

        <stl-vector name="vein_mat" type-name='int32_t' ref-target='inorganic_raw'/>
        <stl-vector name="vein_nested_in" comment='Index of the other vein this one is nested in, or -1'>
            <int16_t refers-to='$$._global.vein_mat[$].ref-target'/>
        </stl-vector>
        <stl-vector name="vein_type">
            <enum base-type='int8_t' type-name='inclusion_type'/>
        </stl-vector>
        <stl-vector name="vein_freq" type-name='int8_t' comment='ignored?'/>

        <int16_t name="top_height" comment='negative'/>
        <int16_t name="bottom_height"/>
    </struct-type>

    <struct-type type-name='world_geo_biome' instance-vector='$global.world.world_data.geo_biomes' original-name='geological_regionst'>
        <enum name='type' type-name='geo_biome_type' base-type='int16_t'/>
        <int16_t name='index'/>

        <code-helper name='describe'>(fmt "~A geo_layers" $.layers.count)</code-helper>

        <stl-vector name="layers" pointer-type='world_geo_layer'/>
    </struct-type>

    <struct-type type-name='world_underground_region'
                 instance-vector='$global.world.world_data.underground_regions'
                 original-name='feature_layerst'>
        <enum name="type" type-name='feature_layer_type'/>

        <compound name='name' type-name='language_name'/>
        <code-helper name='describe'>(describe-obj $.name)</code-helper>

        <int32_t name="index"/>

        <int16_t name="layer_depth" comment='0-2 caves, 3 magma sea, 4 hell'/>
        <int16_t name="layer_depth_p1a" comment='+1'/>
        <int16_t name="layer_depth_p1b"/>
        <int16_t name="water"/>                --  Based on worldgen parameter pair.
        <int16_t name="trees"/>
        <int16_t name="openness_min"/>         --  These parameters correspond to
        <int16_t name="openness_max"/>         --  the similar world gen parameters.
        <int16_t name="passage_density_min"/>  --
        <int16_t name="passage_density_max"/>  --

        <compound name='region_coords' type-name='coord2d_path'/>
        <stl-vector name="region_min_z" type-name='int16_t'/>
        <stl-vector name="region_max_z" type-name='int16_t'/>

        <stl-vector name="associated_histfig" type-name='int32_t' ref-target='historical_figure'/>
        <pointer name="feature_init" type-name='feature_init'/>
    </struct-type>

    <bitfield-type type-name='entity_population_flag' base-type='uint32_t'> bay12: ENTITY_POPULATION_FLAG_*
        <flag-bit name='all_local_links'/>
    </bitfield-type>

    <struct-type type-name='entity_population' key-field='id' instance-vector='$global.world.entity_populations' original-name='entity_populationst'>
        <compound name='name' type-name='language_name'/>

        <code-helper name='describe'>
            (describe-obj $.name)
        </code-helper>

        <stl-vector name='races' type-name='int16_t' ref-target='creature_raw' comment="all the 3 vectors are always the same length, and thus coupled"/>
        <stl-vector name='counts' type-name='int32_t'/>
        <stl-vector name='population_cap' type-name='int32_t' init-value='-1' comment="Set only for cave civs. When set, >= counts. Pre first embark all those are equal"/>
        <stl-vector name='gene_pool' pointer-type='gene_poolst'/>
        <int32_t name='subregion_id' ref-target='world_region'/>
        <int32_t name='layer_id' ref-target='world_underground_region'/>
        <int32_t name='id'/>
        <bitfield name='flags' base-type='uint32_t' type-name='entity_population_flag'/>
        <int32_t name='civ_id' ref-target='historical_entity'/>
    </struct-type>

    <struct-type type-name='world_landmass' original-name='landmassst'
                 instance-vector='$global.world.world_data.landmasses'>
        <compound name='name' type-name='language_name'/>
        <code-helper name='describe'>(describe-obj $.name)</code-helper>

        <int32_t name="index"/>
        <int32_t name="area"/>

        <int32_t name='min_x' since='v0.40.01'/>
        <int32_t name='max_x' since='v0.40.01'/>
        <int32_t name='min_y' since='v0.40.01'/>
        <int32_t name='max_y' since='v0.40.01'/>

        <stl-vector name='temp_x' type-name='int16_t'/>
        <stl-vector name='temp_y' type-name='int16_t'/>
    </struct-type>

    <struct-type type-name='region_headerst'>
        <compound type-name='language_name' name='name'/>
        <stl-string name='display_name'/>
        <static-array name='permission' count='15' type-name='int8_t' index-enum='region_permission_type'/>
        <compound name='last_id' comment='when loading, DF sets *_next_id to these fields plus 1'> not a compound
            <int32_t name='unit'/>
            <int32_t name='soul'/>
            <int32_t name='item'/>
            <int32_t name='entity'/>
            <int32_t name='nemesis'/>
            <int32_t name='artifact'/>
            <int32_t name='building'/>
            <int32_t name='machine'/>
            <int32_t name='hist_figure'/>
            <int32_t name='hist_event'/>
            <int32_t name='hist_event_collection'/>
            <int32_t name='unit_chunk'/>
            <int32_t name='art_image_chunk'/>
            <int32_t name='task'/>
            <int32_t name='squad'/>
            <int32_t name='formation'/>
            <int32_t name='activity'/>
            <int32_t name='interaction_instance'/>
            <int32_t name='written_content'/>
            <int32_t name='identity'/>
            <int32_t name='incident'/>
            <int32_t name='crime'/>
            <int32_t name='vehicle'/>
            <int32_t name='army'/>
            <int32_t name='army_controller'/>
            <int32_t name='army_tracking_info'/>
            <int32_t name='cultural_identity'/>
            <int32_t name='agreement'/>
            <int32_t name='poetic_form' since='v0.42.01'/>
            <int32_t name='musical_form' since='v0.42.01'/>
            <int32_t name='dance_form' since='v0.42.01'/>
            <int32_t name='scale' since='v0.42.01'/>
            <int32_t name='rhythm' since='v0.42.01'/>
            <int32_t name='occupation' since='v0.42.01'/>
            <int32_t name='belief_system' since='v0.44.01'/>
            <int32_t name='image_set' since='v0.47.01'/>
            <int32_t name='divination_set' since='v0.47.01'/>
        </compound>
        <compound type-name='shared_world_headerst' name='world_header'/>
        <stl-string name='filename_noext'/>
    </struct-type>

    -- Unused: map_generatorst
    -- Unused: local_biome_mapst
    -- Unused: region_informationst

    <struct-type type-name='region_edge_datast'>
            <int32_t name='s_dimx'/>
            <int32_t name='s_dimy'/>

            <pointer name='lr_edge_seed' type-name='uint32_t' is-array='true' comment='(region.dimx+1)*(region.dimy+1)'/>
            <pointer name='ud_edge_seed' type-name='uint32_t' is-array='true' comment='(region.dimx+1)*(region.dimy+1)'/>
            <pointer name='square_seed' type-name='uint32_t' is-array='true' comment='region.dimx*region.dimy'/>
            <pointer name='edging_value' type-name='uint8_t' is-array='true' comment='(region.dimx+1)*(region.dimy+1) -- holds ul,u,l edge values for midmaps'/>
    </struct-type>

    <struct-type type-name='entity_influence_sheetst'>
        <static-array count='16' name='influence'>
            <static-array count='16' type-name='uint8_t'
                            comment='1 bit per entity'/>
        </static-array>
    </struct-type>

    <struct-type type-name='entity_influence_blockst'>
        <stl-vector name='entities' type-name='int32_t' ref-target='historical_entity'/>
        <stl-vector name='region_masks' pointer-type='entity_influence_sheetst'/>
    </struct-type>

    <struct-type type-name='entity_influencest'>
        <pointer name="map" is-array='true'>
            <pointer is-array='true' type-name='entity_influence_blockst'/>
        </pointer>
        <int16_t name="width"/>
        <int16_t name="height"/>
    </struct-type>

    <struct-type type-name='entity_territory_sheetst'>
        <static-array count='16' name='territory'>
            <static-array count='16' type-name='uint8_t'
                            comment='1 bit per entity'/>
        </static-array>
    </struct-type>

    <struct-type type-name='entity_territory_blockst'>
        <stl-vector name='entities' type-name='int32_t' ref-target='historical_entity'/>
        <stl-vector name='region_masks' pointer-type='entity_territory_sheetst'/>
    </struct-type>

    <struct-type type-name='entity_territoryst'>
        <pointer name="map" is-array='true'>
            <pointer is-array='true' type-name='entity_territory_blockst'/>
        </pointer>
        <int16_t name="width"/>
        <int16_t name="height"/>
    </struct-type>

    <struct-type type-name='rpd_indicator_datast'>
        <static-array name='line_s_xy' count='1000'><int32_t name='x'/><int32_t name='y'/></static-array>
        <static-array name='line_e_xy' count='1000'><int32_t name='x'/><int32_t name='y'/></static-array>
        <static-array name='line_char' type-name='uint8_t' count='1000'/>
        <static-array name='line_f' type-name='uint8_t' count='1000'/>
        <static-array name='line_b' type-name='uint8_t' count='1000'/>
        <static-array name='line_br' type-name='uint8_t' count='1000'/>
        <int32_t name='line_num'/>

        <static-array name='marker_xy' count='1000'><int32_t name='x'/><int32_t name='y'/></static-array>
        <static-array name='marker_char' type-name='int8_t' count='1000'/>
        <static-array name='marker_f' type-name='int8_t' count='1000'/>
        <static-array name='marker_b' type-name='int8_t' count='1000'/>
        <static-array name='marker_br' type-name='int8_t' count='1000'/>
        <int32_t name='marker_num'/>
    </struct-type>

    <struct-type type-name='region_snapshotst'>
        <int32_t name='year'/>
        <compound name='territory' type-name='entity_territoryst'/>
        <stl-vector name='site_id' type-name='int32_t' ref-target='world_site'/>
        <stl-vector name='site_population' type-name='int32_t'/>
    </struct-type>

    <bitfield-type type-name='region_print_data_flag' base-type='uint32_t'> bay12: REGION_PRINT_DATA_FLAG_*
        <flag-bit name='use_territory'/>
        <flag-bit name='use_territory_civs'/>
        <flag-bit name='use_site_info'/>
        <flag-bit name='use_notes'/>
        <flag-bit name='use_find_results'/>
        <flag-bit name='show_embark_restrictions'/>
        <flag-bit name='show_cliffs'/>
        <flag-bit name='show_elevation'/>
        <flag-bit name='triple_zoomed'/>
        <flag-bit name='show_travel_restriction_site'/>
    </bitfield-type>

    <struct-type type-name='region_print_datast'>
        <pointer name='rss' type-name='region_snapshotst'/>
        <bitfield name='flags' base-type='uint32_t' type-name='region_print_data_flag'/>
        <int32_t name='relevant_id'/>
        <pointer name='highlight_civ_id'><stl-vector type-name='int32_t' ref-target='historical_entity'/></pointer>
        <pointer name='mission_report' type-name='mission_report'/>
        <int32_t name='mission_path_data_index'/>
        <int32_t name='mission_path_data_path_index'/>
        <pointer name='indicator_data' type-name='rpd_indicator_datast'/>
        <static-array name='legend_entity_id' type-name='int32_t' count='50' ref-target='historical_entity'/>
        <int32_t name='legend_entity_id_num'/>
        <int32_t name='mm_cent_x'/>
        <int32_t name='mm_cent_y'/>
        <int32_t name='smm_cent_x'/>
        <int32_t name='smm_cent_y'/>
        <int32_t name='cent_z'/>
        <int32_t name='embark_rectangle_sx'/>
        <int32_t name='embark_rectangle_ex'/>
        <int32_t name='embark_rectangle_sy'/>
        <int32_t name='embark_rectangle_ey'/>
        <static-array type-name='int32_t' count='22' index-enum='embark_finder_option'/>
        <pointer name='find_metal_ore'><stl-vector type-name='int16_t' ref-target='inorganic_raw'/></pointer>
        <pointer name='skip_metal_ore'><stl-vector type-name='int16_t' ref-target='inorganic_raw'/></pointer>
        <int32_t name='highlight_site_id' ref-target='world_site'/>

        <int32_t name='line_start_x'/>
        <int32_t name='line_start_y'/>
        <int32_t name='line_end_x'/>
        <int32_t name='line_end_y'/>
        <bool name='draw_entire_line'/>
    </struct-type>

    <struct-type type-name='world_gen_entity_populationst'>
        <int32_t name='num'/>
        <compound type-name='entity_pop_specifierst' name='pop_spec'/>
    </struct-type>

    <struct-type type-name='world_gen_wandering_groupst'>
        <stl-vector pointer-type='historical_figure' name='wanderer'/>
        <stl-vector pointer-type='world_gen_entity_populationst' name='ent_pop'/>
        <stl-vector pointer-type='world_population' name='rpop'/>
        <pointer type-name='historical_entity' name='ent'/>
        <pointer type-name='world_site' name='cur_location'/>
        <pointer type-name='world_region' name='cur_location_sr'/>
        <pointer type-name='world_underground_region' name='cur_location_fl'/>
        <int32_t name='relocate_delay'/>
        <pointer type-name='wg_site_culturest' name='wg_site_culture'/>
    </struct-type>

    -- Unused: REGION_WALK_*
    -- Unused: GraphicalMapExportModeType

    <struct-type type-name='embark_note' original-name='region_notest'>
        <int8_t name='tile'/>
        <int16_t name='fg_color'/>
        <int16_t name='bg_color'/>
        <stl-string name='name'/>
        <compound name='pos' type-name='coord2d'/>
        <int16_t name='left'/>
        <int16_t name='right'/>
        <int16_t name='top'/>
        <int16_t name='bottom'/>
    </struct-type>

    -- Unused: random_object_paramst

    <struct-type type-name='open_list_node_2Dst'>
        <int32_t name='fval'/>
        <int32_t name='hval'/>
        <int32_t name='x'/>
        <int32_t name='y'/>
    </struct-type>

    <struct-type type-name='open_list_binary_heap_2Dst' since='v0.40.01'>
        <static-array name='node' count='80000' type-name='open_list_node_2Dst'/>
        <int32_t name='size'/>
        <int32_t name='x1'/>
        <int32_t name='y1'/>
        <int32_t name='x2'/>
        <int32_t name='y2'/>
        <int32_t name='nx'/>
        <int32_t name='ny'/>
    </struct-type>

    <struct-type type-name='smm_pathing_blockst'>
        <static-array count='16' name='pmap'><static-array count='16' type-name='int32_t'/></static-array>
        <static-array count='16' name='dirmap'><static-array count='16' type-name='int32_t'/></static-array>
    </struct-type>

    <struct-type type-name='smm_pathing_datast'>
        <static-array count='4' name='mm'><static-array count='4' pointer-type='world_region_details'/></static-array>
        <static-array count='12' name='spb'><static-array count='12' type-name='smm_pathing_blockst'/></static-array>

        <int32_t name='spb_pmap_start'/>
        <int32_t name='spb_pmap_end'/>
        <bool name='spb_pmap_clear'/>
        <bool name='spb_dirmap_clear'/>
    </struct-type>

    <enum-type type-name='region_block_event_type' base-type='int16_t'> bay12: RegionBlockEventType
        <enum-item name='NONE' value='-1'/>
        <enum-item name='SphereField'/>
    </enum-type>

    <class-type type-name='region_block_eventst'>
        <virtual-methods>
            <vmethod ret-type='region_block_event_type' name='getType'/>
            <vmethod name='write_file'> <pointer name='file' type-name='file_compressorst'/> </vmethod>
            <vmethod name='read_file'>
                <pointer name='file' type-name='file_compressorst'/>
                <enum name='loadversion' type-name='save_version'/>
            </vmethod>
            <vmethod name='isEmpty' ret-type='bool'/>
            <vmethod is-destructor='true'/>
        </virtual-methods>
    </class-type>

    <class-type type-name='region_block_event_sphere_fieldst' inherits-from='region_block_eventst'>
        <compound name='tile_bitmask' type-name='tile_bitmask'/>
    </class-type>

    <struct-type type-name='region_blockst'>
        <stl-vector name='event' pointer-type='region_block_eventst'/>
        <stl-vector name='army' pointer-type='army'/>
    </struct-type>

    <struct-type type-name='world_data' original-name='regionst'>
        <compound name='name' type-name='language_name' comment='name of the world'/>

        <static-array name='permission' count='15' type-name='int8_t' index-enum='region_permission_type'/>

        <int32_t name='next_site_id'/>
        <int32_t name='next_resource_pile_id'/>
        <int32_t name='next_resource_allotment_id'/>
        <int32_t name='next_breed_id'/>

        <int32_t name='next_battlefield_id' since='v0.34.01'/>
        <int32_t name='next_region_weather_id' since='v0.34.01'/>

        <int32_t name='world_width'/>
        <int32_t name='world_height'/>
        <int32_t name='moon_angle'/>
        <int32_t name='moon_phase'/>
        <enum name='flip_latitude' base-type='int16_t' type-name='pole_type'/>
        <enum name='flip_longitude' base-type='int16_t' type-name='sunrise_type'/>
        <static-array name='incoming_temp' count='3' type-name='int16_t'/>
        <static-array name='front_count' count='3' type-name='int16_t'/>

        <compound name='edge_data' type-name='region_edge_datast'/>

        <compound name='midmap_data' type-name='region_midmap_datast'/>

        <compound name='constructions'> bay12: world_construction_datast
            <int16_t name="width"/>
            <int16_t name="height"/>

            <pointer name="map" is-array='true'>
                <pointer is-array='true'> bay12: world_construction_data_blockst
                    <stl-vector pointer-type='world_construction_square'/>
                </pointer>
            </pointer>

            <stl-vector name="list" pointer-type='world_construction'/>
            <int32_t name="next_id"/>
        </compound>

        <compound name="entity_influence" type-name='entity_influencest'/>
        <compound name="entity_territory" type-name='entity_territoryst'/>

        <stl-vector name="sites" pointer-type='world_site'/>

        <stl-vector name="resource_pile" pointer-type='resource_pilest'/>

        <stl-vector name="resource_allotments" pointer-type='resource_allotment_data' comment='bay12: production_zone'/>

        <stl-vector name='breeds' pointer-type='breed'/>
        <stl-vector name='battlefields' pointer-type='battlefield' since='v0.34.01' />
        <stl-vector name='region_weather' pointer-type='region_weather' since='v0.34.01'/>

        <stl-vector name='object_data' pointer-type='world_object_data' since='v0.34.01'/>

        <stl-vector name="landmasses" pointer-type='world_landmass'/>
        <stl-vector name="regions" pointer-type='world_region'/>
        <stl-vector name="underground_regions" pointer-type='world_underground_region'/>
        <stl-vector name="geo_biomes" pointer-type='world_geo_biome'/>
        <stl-vector name="mountain_peaks" pointer-type='world_mountain_peak'/>
        <stl-vector name="rivers" pointer-type='world_river'/>

        <pointer name="region_map" is-array='true'>
            <pointer is-array='true' type-name='region_map_entry'/>
        </pointer>
        <pointer name="variant_flag" type-name='uint16_t' is-array='true' comment='size: dimx*dimy'/>
        <pointer name='corner_variant_flag' type-name='uint8_t' is-array='true' comment='size: (dimx+1)*(dimy+1)'/>
        <pointer name='feature_map_seed' type-name='uint32_t' is-array='true' comment='size: ((dimx+15)>>4)*((dimy+15)>>4)'/>
        <int16_t name="olookx"/>
        <int16_t name="olooky"/>

        <stl-vector name="embark_notes" pointer-type='embark_note'/>

        <static-array name='region_block' count='6'>
            <pointer is-array='true'>
                <pointer is-array='true' type-name='region_blockst'/>
            </pointer>
        </static-array>

        <compound name='smm_pathing_data' type-name='smm_pathing_datast'/>

        <stl-vector name="active_site" pointer-type='world_site'/>

        <pointer name="feature_map" is-array='true'>
            <pointer is-array='true' type-name='feature_map_shellst'/>
            <comment>
                Additional feature_map information:
                The feature_map is a two dimensional structure dividing the world into 16 * 16
                world tile "feature shells" (and remember that there's a single tile wide shell
                at the end of each dimension, so a pocket world has a shell dimension of 2 * 2).
                These shells are loaded and unloaded dynamically, which means trying to access a
                shell that isn't the one in DF's focus (where the fortress/adventurer/pre embark
                cursor is) is invalid and can lead to DF crashing.
                The "features.feature_init" 16 * 16 structure contains the features of each of
                the corresponding world tiles within the shell. However, DF only loads the
                feature vectors for the world tiles in focus, although they seem to remain
                loaded until the shell is unloaded. Until loaded the vectors have a size of 0.
                Manipulation of the features is usually preserved as feature vectors are
                unloaded/reloaded, so spires can be elongated and rivers added, but some
                details, such as river fauna, seem to be generated on loading. Added features
                may not necessarily be reloaded at the vector index they were created at.
            </comment>
        </pointer>

        <stl-vector name="old_sites" type-name='int32_t' ref-target='world_site'/>
        <stl-vector name="old_site_x" type-name='int32_t'/>
        <stl-vector name="old_site_y" type-name='int32_t'/>

        <compound name='land_rgns' type-name='coord2d_path' comment='bay12: migrant_entry'/>

        <int32_t name="path_start"/>
        <int8_t name="path_clear"/>
        <int32_t name="temp_value_start"/>
        <int8_t name="temp_value_clear"/>
        <int32_t name="old_temp_value_advance"/>

        exists during worldgen only, before it finishes
        <stl-vector name="world_gen_wandering_group" pointer-type='world_gen_wandering_groupst'/>

        <compound name='open_list' since='v0.40.01' type-name='open_list_binary_heap_2Dst'/>
    </struct-type>

    <struct-type type-name='world_generatorst'>
        <enum base-type='int16_t' name='state'> bay12: ???
            <enum-item name='None' value='-1'/>
            <enum-item name='Initializing'/>
            <enum-item name='PreparingElevation'/>
            <enum-item name='SettingTemperature'/>
            <enum-item name='RunningRivers'/>
            <enum-item name='FormingLakesAndMinerals'/>
            <enum-item name='GrowingVegetation'/>
            <enum-item name='VerifyingTerrain'/>
            <enum-item name='ImportingWildlife'/>
            <enum-item name='RecountingLegends'/>
            <enum-item name='Finalizing'/>
            <enum-item name='Done'/>
        </enum>
        <int32_t name='num_rejects'/>
        <static-array name='skip_reject' count='53' type-name='int32_t'/>
        <static-array name='reject_type' count='53' type-name='int32_t'/>
        <int16_t name='rejection_reason'/>
        <int32_t name='new_dimx'/>
        <int32_t name='new_dimy'/>
        <int32_t name='lake_x'/>
        <int32_t name='geoindex'/>
        <int32_t name='max_geo_index'/>
        <static-array name='geo_layers' count='100' pointer-type='world_geo_layer'/>
        <static-array name='placement_freq' count='100' type-name='int8_t'/>
        <static-array name='placement_parent' count='100' type-name='int16_t'/>
        <int32_t name='have_logged_parameters'/>
        <int32_t name='finalized_civ_mats'/>
        <int32_t name='finalized_art'/>
        <int32_t name='finalized_uniforms'/>
        <int32_t name='finalized_sites'/>
        <int32_t name='rampage_num'/>
        <stl-vector name='entities' pointer-type='historical_entity'/>
        <stl-vector name='sites' pointer-type='world_site'/>
        <int32_t name='cursor_x'/>
        <int32_t name='cursor_y'/>
        <compound name='riverstart' type-name='coord2d_path'/>
        <int32_t name='rivers_total'/>
        <int32_t name='rivers_cur'/>
        <int8_t name='last_used_valid'/>
        <stl-string name='last_param_set'/>
        <stl-string name='last_seed'/>
        <stl-string name='last_history_seed'/>
        <stl-string name='last_name_seed'/>
        <stl-string name='last_creature_seed'/>
        <bool name='prehistory_initialized'/>
        <bool name='placed_caves'/>
        <bool name='placed_good_evil'/>
        <bool name='placed_megabeasts'/>
        <bool name='placed_other_beasts'/>
        <bool name='made_cave_pops'/>
        <bool name='made_cave_civs'/>
        <bool name='finished_prehistory'/>
        <stl-vector name='mythical_site' pointer-type='world_site'/>
        <stl-vector name='caves' pointer-type='world_site'/>
        <stl-vector name='orig_cave' pointer-type='world_site'/>
        <int32_t name='current_bandit_num'/>
        <bool name='have_placed_controllable'/>
        <bool name='placed'/>
        <bool name='skip_controllable'/>
        <bool name='just_continued'/>
        <stl-vector name='entity_raws' pointer-type='entity_raw'/>
        <stl-vector name='entity_race' type-name='int16_t'/>
        <int32_t name='civ_count'/>  --  Only valid during civ placement phase
        <int32_t name='civs_left_to_place'/>  --  Ditto
        <static-array name='normal_regions' count='10'>
            <stl-vector pointer-type='world_region'/>
        </static-array>
        <static-array name='good_regions' count='10'>
            <stl-vector pointer-type='world_region'/>
        </static-array>
        <static-array name='evil_regions' count='10'>
            <stl-vector pointer-type='world_region'/>
        </static-array>
        <stl-vector name='cave_choice_x' type-name='int32_t'/>
        <stl-vector name='cave_choice_y' type-name='int32_t'/>
        <stl-vector name='final_cave_choice_x' type-name='int32_t'/>
        <stl-vector name='final_cave_choice_y' type-name='int32_t'/>
        <stl-vector name='o_final_cave_choice_x' type-name='int32_t'/>
        <stl-vector name='o_final_cave_choice_y' type-name='int32_t'/>
        <int32_t name='mountain_cave_left'/>
        <int32_t name='non_mountain_cave_left'/>
        <int32_t name='mythical_site_left'/>

        <stl-vector name='candidate_demon_c' type-name='int16_t' since='v0.40.01'/>
        <stl-vector name='candidate_demon_cc' type-name='int16_t' since='v0.40.01'/>
        <stl-vector name='libraries' pointer-type='abstract_building_libraryst' since='v0.42.01'/>
        <int32_t name='book_count' since='v0.42.01'/>
        <stl-vector name='temples' pointer-type='abstract_building_templest' since='v0.44.01'/>
        <stl-vector name='holy_relics' pointer-type='artifact_record' since='v0.44.01'/>
        <stl-vector name='disaster_site' pointer-type='world_site' since='v0.47.01'/>
        <stl-vector name='building_usage_move_check_hfid' type-name='int32_t' ref-target='historical_figure' since='v0.47.01'/>

        <int32_t name='prepare_civs_step'/>
        <stl-vector name='move_civ' pointer-type='historical_entity'/>
        <stl-vector name='move_civ_ll' pointer-type='historical_entity'/>
        <stl-vector name='move_site' pointer-type='historical_entity'/>
        <stl-vector name='move_subsite' pointer-type='historical_entity'/>
        <stl-vector name='move_religion' pointer-type='historical_entity'/>
        <stl-vector name='move_wgwg' pointer-type='world_gen_wandering_groupst'/>
        <stl-vector name='move_beast' pointer-type='historical_figure'/>
        <stl-vector name='move_civ_actor' pointer-type='historical_figure'/>
        <stl-vector name='move_plotter_actor' pointer-type='historical_figure'/>
        <int32_t name='predator_num'/>
        <int32_t name='lph_num'/>
        <int32_t name='wk'/>
        <compound name='text_box' type-name='markup_text_boxst'/>
        <ulong name='last_chronicle_add_time'/>
        <int32_t name='last_event_id_added'/>

        <stl-vector name='mythical_sphere' type-name='sphere_type'/>
    </struct-type>
</data-definition>

<!--
Local Variables:
indent-tabs-mode: nil
nxml-child-indent: 4
End:
-->
