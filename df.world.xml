<data-definition>
    <enum-type type-name='units_other_id'>
        <enum-item name='ANY_RIDER'/>
        <enum-item name='ANY_BABY'/>
    </enum-type>

    <df-other-vectors-type type-name='units_other' index-enum='units_other_id' item-type='unit'>
    </df-other-vectors-type>

    <struct-type type-name='unit_context_block' original-name='unit_context_blockst'>
        <static-array name='context_unit' pointer-type='unit' count='200' />
        <int32_t name="num"/>
    </struct-type>

    <struct-type type-name='random_object_infost'>
        <stl-vector pointer-type='random_object_batchst' name='batch'/>
    </struct-type>

    <enum-type type-name='unit_reaction_type' base-type='int32_t'> bay12: UnitReactionType
        <enum-item name='NONE' value='-1'/>
        <enum-item name='STRANGER'/>
        <enum-item name='GOOD_FAMILY'/>
        <enum-item name='MURDERER'/>
        <enum-item name='MYSELF'/>
        <enum-item name='CANNOT_BECAUSE_IT_IS_ETHEREAL'/>
        <enum-item name='CANNOT_BECAUSE_IT_IS_INACCESSIBLE'/>
        <enum-item name='EQUIPMENT'/>
        <enum-item name='CANNOT_BECAUSE_I_AM_ETHEREAL'/>
        <enum-item name='ARENA_TARGET'/>
        <enum-item name='ARENA_BUDDY'/>
        <enum-item name='I_AM_CHAINED_AND_YOU_ARE_LCU'/>
        <enum-item name='I_AM_LED_AND_YOU_ARE_LCU'/>
        <enum-item name='I_AM_LCU_AND_YOU_ARE_CHAINED'/>
        <enum-item name='I_AM_LCU_AND_YOU_ARE_LED'/>
        <enum-item name='SOMEBODY_IS_CRAZE'/>,
        <enum-item name='NOT_LIVING_IS_FINE'/>
        <enum-item name='LIVING_MUST_BE_KILLED'/>
        <enum-item name='EVIL_DEAD'/>
        <enum-item name='WE_ARE_SAME_RACE_WILDERNESS_ANIMALS'/>
        <enum-item name='PREDATOR_OR_PREY'/>
        <enum-item name='BENIGN_ANIMAL'/>
        <enum-item name='DANGEROUS_ANIMAL'/>
        <enum-item name='NEIGHBOR'/>
        <enum-item name='YOU_ARE_MY_PRISONER'/>
        <enum-item name='MASTER'/>
        <enum-item name='APPRENTICE'/>
        <enum-item name='TRAVELING_COMPANION'/>
        <enum-item name='LOVER'/>
        <enum-item name='HATED_GROUP'/>
        <enum-item name='ENEMY_FIGHTER'/>
        <enum-item name='MONSTER'/>
        <enum-item name='FORMER_MASTER'/>
        <enum-item name='FORMER_APPRENTICE'/>
        <enum-item name='SAME_CULTURE'/>
        <enum-item name='INTRUDER'/>
    </enum-type>

    <struct-type type-name='world'>
        <compound name='event' type-name='event_handlerst'/>

        <compound name='effects' type-name='effect_handlerst'/>

        <compound name='coin_batches' type-name='coinbatch_handlerst'/>

        bay12: wilderpop_handlerst
        <stl-vector name='populations' pointer-type='local_population'/>

        --
        <compound name='manager_orders'> bay12: workquota_handlerst
            <stl-vector name='all' pointer-type='manager_order'/>
            <int32_t name='manager_order_next_id'/>
        </compound>

        <compound name='mandates' type-name='mandate_handlerst'/>

        --  Entities

        <compound name='entities' type-name='entity_handlerst'/>

        -- Units

        <compound name='units'> bay12: unit_handlerst
            <stl-vector name='all' pointer-type='unit'/>

            <stl-vector name='active' pointer-type='unit' comment='not sorted, entry 0 is adventurer'/>

            <compound name='other' type-name='units_other'/>

            <pointer name='adv_unit' type-name='unit'/>
            <stl-vector name='temp_save' has-bad-pointers='true' pointer-type='unit'/>
            <stl-vector name='unit_context_block' pointer-type='unit_context_block' since='v0.44.06'/>
        </compound>

        -- Unit and Art Chunks

        bay12: unit_chunk_handlerst
        <stl-vector name='unit_chunks' pointer-type='unit_chunk'/>
        <compound name='art_image_chunks' type-name='art_image_chunk_handlerst'/>

        -- Nemesis

        <compound name='nemesis' type-name='nemesis_handlerst'/>

        -- Items

        <compound name='items' type-name='item_handlerst'/>

        -- Artifacts

        <compound name='artifacts' type-name='artifact_handlerst'/>

        -- Jobs and projectiles

        <compound name='jobs' type-name='job_handler'/>

        <compound name='projectiles' type-name='proj_handlerst'/>

        -- Buildings

        <compound name='buildings' type-name='building_handler'/>

        -- Machines (connected groups of gears and so on)

        <compound name='machines' type-name='machine_handler'/>

        -- Flow guides (whatever those are)

        <compound name='flow_guides' type-name='flow_guide_handlerst'/>

        -- Stockpile classifier

        <compound name='stockpile' type-name='storage_handlerst'/>

        -- Plants

        <compound name='plants'> bay12: veg_handlerst
            <stl-vector name='all' pointer-type='plant'/>
            <stl-vector name='shrub_dry' pointer-type='plant'/>
            <stl-vector name='shrub_wet' pointer-type='plant'/>
            <stl-vector name='tree_dry' pointer-type='plant'/>
            <stl-vector name='tree_wet' pointer-type='plant'/>
            <stl-vector name='temp_save' pointer-type='plant' has-bad-pointers='true'/>
        </compound>

        <compound name='enemy_status_cache'> bay12: unit_reaction_handlerst
            <static-array name='slot_used' type-name='bool' count='500'/>
            <static-array name='rel_map' count='500'>
                <static-array type-name='unit_reaction_type' count='500'/> bay12: unit_reactionst
            </static-array>
            <int32_t name='next_slot'/>
        </compound>

        <compound name='schedules' type-name='schedule_handlerst'/>

        <compound name='squads' type-name='squad_handlerst'/>

        <compound name='formations' type-name='formation_handlerst'/>

        -- Drills

        <compound name='activities' type-name='activity_handlerst'/>

        -- Reports and announcements

        <compound name='status' type-name='announcement_handlerst'/>

        <compound name='interaction_instances' type-name='interaction_instance_handlerst'/>

        <compound name='written_contents'> bay12: written_content_handlerst
            <stl-vector name='all' pointer-type='written_content'/>
            <stl-vector name='order_load' has-bad-pointers='true' pointer-type='written_content'/>
        </compound>

        <compound name='identities' type-name='identity_handlerst'/>

        <compound name='incidents' type-name='incident_handlerst'/>

        <compound name='crimes' type-name='crime_handlerst'/>

        <compound name='vehicles' since='v0.34.08'> bay12: vehicle_handlerst
            <stl-vector name='all' pointer-type='vehicle'/>
            <stl-vector name='active' pointer-type='vehicle'/>
            <stl-vector name='order_load' has-bad-pointers='true' pointer-type='vehicle'/>
        </compound>

        <compound name='armies' since='v0.40.01' type-name='army_handlerst'/>

        <compound name='army_controllers' since='v0.40.01' type-name='army_controller_handlerst'/>

        <compound name='army_tracking_info' since='v0.40.01' type-name='army_tracking_info_handlerst'/>

        <compound name='cultural_identities' type-name='cultural_identity_handlerst' since='v0.40.01'/>

        <compound name='agreements' type-name='agreement_handlerst' since='v0.40.01'/>

        <compound name='poetic_forms' type-name='poetic_form_handlerst' since='v0.42.01'/>

        <compound name='musical_forms' type-name='musical_form_handlerst' since='v0.42.01'/>

        <compound name='dance_forms' since='v0.42.01' type-name='dance_form_handlerst'/>

        <compound name='scales' since='v0.42.01' type-name='scale_handlerst'/>

        <compound name='rhythms' since='v0.42.01' type-name='rhythm_handlerst'/>

        <compound name='occupations' type-name='occupation_handlerst' since='v0.42.01'/>

        <compound name='belief_systems' since='v0.44.01' type-name='belief_system_handlerst'/>

        <compound name='image_sets' since='v0.47.01' type-name='image_set_handlerst'/>

        <compound name='divination_sets' type-name='divination_set_handlerst' since='v0.47.01'/>

        <pointer name='selected_building' type-name='building'/>
        <enum base-type='int16_t' name='selected_stockpile_type' type-name='stockpile_category'/>
        <bool name='update_selected_building'/>
        <int16_t name='building_width'/>
        <int16_t name='building_height'/>
        <enum name='selected_direction' base-type='int8_t' type-name='screw_pump_direction'/>

        <compound name='map'> not a compound, beware of alignment problems
            <stl-vector name='map_blocks' pointer-type='map_block'/>
            <pointer name='block_index' is-array='true'>
                <pointer is-array='true'>
                    <pointer is-array='true'>
                        <pointer type-name='map_block'/>
                    </pointer>
                </pointer>
            </pointer>

            <stl-vector name='map_block_columns' pointer-type='map_block_column'/>
            <pointer name='column_index' is-array='true'>
                <pointer is-array='true'>
                    <pointer type-name='map_block_column'/>
                </pointer>
            </pointer>

            <int32_t name='x_count_block'/>
            <int32_t name='y_count_block'/>
            <int32_t name='z_count_block'/>
            <int32_t name='x_count'/>
            <int32_t name='y_count'/>
            <int32_t name='z_count'/>
            <int32_t name='region_x'/>
            <int32_t name='region_y'/>
            <int32_t name='region_z'/>
            <static-array name='distance_lookup' count='53' comment='bay12: lightrad'>
                <static-array count='53' type-name='int16_t'
                              comment='Appears to be precomputed rounded integer distances'/>
            </static-array>
        </compound>

        <compound name='profession_skills'> not a compound, beware of alignment problems
            <static-array name='primary' index-enum='profession' since='v0.40.01' comment='bay12: u_skill_pick'>
                <stl-vector type-name='job_skill'/>
            </static-array>
            <static-array name='secondary' index-enum='profession' since='v0.40.01' comment='bay12: u_mskill_pick'>
                <stl-vector type-name='job_skill'/>
            </static-array>
        </compound>

        <compound name='math'> not a compound, beware of alignment problems
            <static-array name='approx' count='40' since='v0.40.01' comment='bay12: precalc_vision_arc; 10 * cosine/sine of the index in units of 1/40 of a circle, rounded towards 0'>
                <int32_t name='cos'/>
                <int32_t name='sin'/>
            </static-array>
            <static-array name='cos' count='181' type-name='d-float' since='v0.40.01' comment='bay12: precalc_vision_dot; 100 * cosine of the index in degrees'/>
            <static-array name='hypot' count='11' since='v0.40.01' comment='bay12: precalc_vision_sqrt; square root of the sum of the squares of the indices'>
                <static-array count='11' type-name='d-float'/>
            </static-array>
        </compound>

        <compound name='map_extras'> not a compound, beware of alignment problems
            <int8_t name='rotation'/>

            <pointer type-name='z_level_flags' name='z_level_flags'
                     is-array='true' since='v0.34.05' comment='bay12: temp_block_layer_flag'/>

            <stl-vector name='inactive_spoor_bse' pointer-type='block_square_event_spoorst' since='v0.40.01'/>
            <stl-vector name='inactive_spoor_bse_abs_smm_x' type-name='int16_t' since='v0.40.01'/>
            <stl-vector name='inactive_spoor_bse_abs_smm_y' type-name='int16_t' since='v0.40.01'/>
            <stl-vector name='inactive_spoor_bse_abs_smm_z' type-name='int16_t' since='v0.40.01'/>
        </compound>

        <pointer name='world_data' type-name='world_data'/>

        <compound name='worldgen_status' type-name='world_generatorst'/>

        <compound name='orphaned_flow_pool' type-name='flow_reuse_pool'/>

        -- raws

        <compound name='raws' type-name='world_raws'/> NOT A COMPOUND!

        <compound name='area_grasses' comment="grasses in world tiles around embark. Populated at embark"> not a compound
            <compound name='world_tiles' type-name='coord2d_path' comment="local_wilderpop"/>
            <stl-vector name='layer_grasses' comment="one per layer per world tile">
                <pointer> bay12: grass_selectionst
                    <compound name='ref' type-name='world_population_ref'/>
                    <stl-vector name='grasses'>
                        <int32_t ref-target='plant_raw'/>
                    </stl-vector>
                </pointer>
            </stl-vector>
        </compound>

        <compound name='flow_engine'> not a compound
            <int8_t name='rnd_16' comment='flow_direction'/>
            <int16_t name='rnd_256' comment='flow_index'/>
            <int16_t name='rnd_pos' comment='flow_index_count'/>
            <static-array name='rnd_x' type-name='int16_t' count='16'/>
            <static-array name='rnd_y' type-name='int16_t' count='16'/>

            <int32_t name='block_idx' refers-to='$$._global.map.map_blocks[$]'/>

            <compound name='sink_checked' type-name='coord_path'/>
            <stl-vector name='sink_checked_timer' type-name='int16_t'/>
        </compound>

        <compound name='building_uses' type-name='building_use_controllerst'/>

        <df-flagarray name='flags' index-enum='world_flags'/>
        <enum type-name='save_version' name='original_save_version' comment='DF version on which the world was first created'/>

        <compound name='worldgen'> not a compound
            <stl-string name='version'/>
            <int32_t name="next_unit_chunk_id"/>
            <int16_t name="next_unit_chunk_offset"/>
            <int32_t name="next_art_image_chunk_id"/>
            <int16_t name="next_art_image_chunk_offset"/>

            <compound name='worldgen_parms' type-name='worldgen_parms'/>
        </compound>

        <compound name='history_rng' type-name='hash_rngst'/>

        -- hist figures

        -- bay12: historyst
        <compound name='history' type-name='world_history'/>

        <stl-vector name='entity_populations' pointer-type='entity_population'/>

        <compound name='daily_events'> bay12: world_yearly_schedulest
            <static-array name='deaths' since='v0.40.01' count='336'>
                <stl-vector type-name='int32_t' ref-target='nemesis_record'/>
            </static-array>
            <static-array name='pregnancies' since='v0.40.01' count='336'>
                <stl-vector type-name='int32_t' ref-target='nemesis_record'/>
            </static-array>
            <static-array name='births' since='v0.40.01' count='336'>
                <stl-vector type-name='int32_t' ref-target='nemesis_record'/>
            </static-array>
            <static-array name='grown_up' since='v0.40.01' count='336'>
                <stl-vector type-name='int32_t' ref-target='nemesis_record'/>
            </static-array>
            <static-array name='marriage_1' since='v0.40.01' count='336'>
                <stl-vector type-name='int32_t' ref-target='nemesis_record'/>
            </static-array>
            <static-array name='marriage_2' since='v0.40.01' count='336'>
                <stl-vector type-name='int32_t' ref-target='nemesis_record' comment="same length as corresponding previous vector element. Not true for other pairs"/>
            </static-array>
        </compound>
        <compound type-name='random_object_infost' name='random_object_info' since='v0.42.01'/>

        <stl-vector name='fake_world_info' since='v0.40.01'> bay12: fake_world_infost
            <pointer> bay12: fake_world_info_languagest
                <stl-string name='name'/>
                <bitfield name='flags' base-type='uint32_t'> bay12: FWI_LANGUAGE_FLAG_*
                    <flag-bit name='tonal'/>
                    <flag-bit name='stressed'/>
                    <flag-bit name='quantitative_stress'/>
                </bitfield>
                <int32_t name='rhyme_level'/>
            </pointer>
        </stl-vector>
        <stl-vector name='family_info' since='v0.44.01'> bay12: family_infost
            <pointer> bay12: familyst
                <int32_t name='hfid' ref-target='historical_figure'/>
                <stl-vector name='claims'>
                    <pointer> bay12: family_artifact_claimst
                        <int32_t name='artifact' ref-target='artifact_record'/>
                        <enum name='type' type-name='artifact_claim_type'/>
                        <int32_t name='year'/>
                        <int32_t name='year_tick' init-value='-1'/>
                        <int32_t name='renounced_heid' ref-target='history_event'/>
                    </pointer>
                </stl-vector>
                <int32_t name='current_family_head_hfid' ref-target='historical_figure' comment="hfid or completely unrelated hf seen?"/>
                <int32_t name='current_family_head_birth_year' init-value='0' comment="only seen 0"/>
                <int32_t name='current_family_head_birth_season_count' init-value='0' comment="only seen 0"/>
            </pointer>
        </stl-vector>

        <compound type-name='map_viewport' name='viewport'/>

        <int32_t name='artifact_history_suppression_count' since='v0.44.01'/>

        <bool name="reindex_pathfinding" comment='forces map_block.passable to be recomputed'/>

        <int32_t name='frame_counter' comment='increases by 1 every time . is pressed'/>

        <stl-vector name='orphaned_flows' pointer-type='flow_info' comment='flows that are not tied to a map_block'/>

        <compound name='pathfinder'> not a compound
            <compound name='heap'> bay12: open_list_binary_heapst
                <static-array name='boundary_heap' count='80000'> bay12: open_list_nodest
                    <comment>A heap of current boundary tiles.</comment>
                    <int32_t name='total_cost'/>
                    <int32_t name='local_cost'/>
                    <int16_t name='x'/>
                    <int16_t name='y'/>
                    <int16_t name='z'/>
                </static-array>
                <int32_t name='heap_count'/>

                <compound name='pos1' type-name='coord'/>
                <compound name='pos2' type-name='coord'/>

                -- Not quite simple distance, it seems:
                <int32_t name='dist_x'/>
                <int32_t name='dist_y'/>
                <int32_t name='dist_z'/>
            </compound>

            <int32_t name='pathstart'/>
            <int8_t name='pathclear'/>
            <uint16_t name='direction_start'/>
            <int8_t name='direction_clear'/>
            <int16_t name='next_levelmap'/>
            <int16_t name='cur_veg_move_stage'/>
            <bool name='preparing_map'/>
        </compound>

        <int32_t name='save_version'/>

        <compound name='cur_savegame'> not a compound
            <stl-string name='save_dir'/>
            <compound name='world_header' type-name='shared_world_headerst'/>
            <bool name='civ_history_complete'/>
            <bool name='must_end_civ_history'/>
        </compound>

        <compound name='rod_loader' since='v0.40.01'> bay12: rod_loaderst
            <enum base-type='int32_t' name='state'> bay12: PrepareRodStageType
                <enum-item name='LoadMusic'/>
                <enum-item name='LoadObjects'/>
                <enum-item name='SortText'/>
                <enum-item name='SortLanguages'/>
                <enum-item name='SortDescriptors'/>
                <enum-item name='SortMaterialTemplates'/>
                <enum-item name='SortInorganics'/>
                <enum-item name='SortPlants'/>
                <enum-item name='SortTissueTemplates'/>
                <enum-item name='SortItems'/>
                <enum-item name='SortBuildings'/>
                <enum-item name='SortBodyDetailPlans'/>
                <enum-item name='SortCreatureBodies'/>
                <enum-item name='SortCreatureVariation'/>
                <enum-item name='SortCreatures'/>
                <enum-item name='SortEntities'/>
                <enum-item name='SortReactions'/>
                <enum-item name='SortInteractions'/>
                <enum-item name='SortMusic'/>
                <enum-item name='SortSound'/>

                <enum-item name='ProcessLanguages'/>
                <enum-item name='ProcessInorganics'/>
                <enum-item name='ProcessPlants'/>
                <enum-item name='ProcessItems'/>
                <enum-item name='ProcessCreatures'/>
                <enum-item name='ProcessEntities'/>
                <enum-item name='ProcessReactions'/>
                <enum-item name='ProcessInteractions'/>
                <enum-item name='ProcessMusic'/>
                <enum-item name='ProcessSound'/>

                <enum-item name='FinalizeLanguages'/>
                <enum-item name='FinalizeDescriptors'/>
                <enum-item name='FinalizeMaterialTemplates'/>
                <enum-item name='FinalizeInorganics'/>
                <enum-item name='FinalizePlants'/>
                <enum-item name='FinalizeTissueTemplates'/>
                <enum-item name='FinalizeItems'/>
                <enum-item name='FinalizeBuildings'/>
                <enum-item name='FinalizeBodyDetailPlans'/>
                <enum-item name='FinalizeCreatureVariation'/>
                <enum-item name='FinalizeCreatures'/>
                <enum-item name='FinalizeEntities'/>
                <enum-item name='FinalizeReactions'/>
                <enum-item name='FinalizeInteractions'/>
                <enum-item name='FinalizeMusic'/>
                <enum-item name='FinalizeSound'/>

                <enum-item name='InitMaterialData'/>
                <enum-item name='CustomInorganics'/>
                <enum-item name='CustomPlants'/>
                <enum-item name='CustomItems'/>
                <enum-item name='CustomCreatures'/>
                <enum-item name='CustomEntities'/>
                <enum-item name='CustomReactions'/>
                <enum-item name='CustomInteractions'/>
                <enum-item name='FinalizeCustomObjects'/>
                <enum-item name='Graphics'/>
                <enum-item name='Done'/>
            </enum>
            <int32_t name='progress' comment='0..19' since='v0.40.01'/>
            <int32_t name='verify_load_order_index'/>
            <bool name='asking_about_update'/>
            <bool name='notifying_about_failure'/>
            <enum base-type='int32_t' name='notifying_about_failure_mod_install_err'> bay12: ModInstallErrorType
                <enum-item name='GENERAL'/>
                <enum-item name='NONE' value='2'/> Toady forgot to set this to -1
            </enum>
            <pointer type-name='mod_headerst' name='newest_mh'/>
            <pointer type-name='mod_headerst' name='current_mh'/>
            <bitfield name='flag' base-type='uint32_t'> bay12: ROD_LOADER_FLAG_*
                <flag-bit name='UPDATE_ALL_OLD_MODS'/>
                <flag-bit name='KEEP_ALL_OLD_MODS'/>
            </bitfield>
        </compound>

        <compound name='object_loader'> bay12: object_loaderst
            <int32_t name='load_object_stage'/>
            <int32_t name='load_object_stage_count'/>
            <stl-vector name='object_files' since='v0.40.01' type-name='ptr-string'/>
            <int32_t name='object_file_index' since='v0.40.01' refers-to='$$._parent.object_files[$]'/>

            <int32_t name='current_load_order_index'/>
            <int32_t name='current_load_order_graphics_index'/>
            <stl-vector pointer-type='stl-string' name='object_load_order_id'/>
            <stl-vector type-name='int32_t' name='object_load_order_numeric_version'/>
            <stl-vector type-name='int32_t' name='object_load_order_earliest_compat_numeric_version'/>
            <stl-vector pointer-type='stl-string' name='object_load_order_src_dir'/>
            <stl-string name='src_dir'/>
            <stl-vector pointer-type='stl-string' name='object_load_order_name'/>
            <stl-vector pointer-type='stl-string' name='object_load_order_displayed_version'/>
        </compound>

        <int32_t name='temp_pop_breeding_start'/>

        <compound name='features'> not a compound
            <stl-vector name='wg_market_site' pointer-type='world_site' since='v0.47.01'/>
            <stl-vector name='map_features' pointer-type='feature_init'/>
            <stl-vector type-name='int16_t' name='feature_x'/>
            <stl-vector type-name='int16_t' name='feature_y'/>
            <stl-vector type-name='int16_t' name='feature_local_idx' comment='same as map_block.local_feature'/>
            <stl-vector type-name='int32_t' name='feature_global_idx' ref-target='world_underground_region'/>

            <stl-vector pointer-type='feature_init' name='newpop_feature'/>
            <stl-vector type-name='int16_t' name='newpop_ax'/>
            <stl-vector type-name='int16_t' name='newpop_ay'/>
            <stl-vector type-name='int16_t' name='newpop_dx'/>
            <stl-vector type-name='int16_t' name='newpop_dy'/>
            <stl-vector type-name='int16_t' name='newpop_feature_ind'/>
            <stl-vector type-name='int32_t' name='newpop_feature_layer'/>
            <stl-vector type-name='int32_t' name='newpop_feature_layer_sq'/>
            <stl-vector type-name='int16_t' name='newpop_layer_depth'/>
            <stl-vector type-name='int16_t' name='newpop_sx'/>
            <stl-vector type-name='int16_t' name='newpop_sy'/>
            <stl-vector type-name='int16_t' name='newpop_min_z'/>
            <stl-vector type-name='int16_t' name='newpop_mid_z'/>
            <stl-vector type-name='int16_t' name='newpop_max_z'/>
            <stl-bit-vector name='newpop_from_saved_pop' since='v0.40.11'/>
        </compound>

        <bool name='allow_announcements' comment='announcements will not be processed at all if false'/>
        <bool name='suppress_minevent_announcements'/>
        <bool name='updating_region' since='v0.42.01'/>

        <compound name='arena'> bay12: arenast
            <stl-vector name='templates'>
                <pointer> bay12: arena_profilest
                    <stl-string name='token'/>
                    <stl-string name='display_name'/>
                    <compound name='start_center' type-name='coord'/>
                    <compound name='dim' type-name='coord2d'/>
                    <stl-vector name='level'>
                        <pointer> bay12: arena_profile_levelst
                            <stl-vector name='level_str' pointer-type='stl-string'/>
                        </pointer>
                    </stl-vector>
                </pointer>
            </stl-vector>
            <int32_t name='cur_template_idx'/>
            <stl-vector name='race' type-name='int16_t' ref-target='creature_raw'/>
            <stl-vector name='caste' type-name='int16_t' ref-target='caste_raw' aux-value='$$._parent.race[$._key]'/>

            <int16_t name='last_race' refers-to='$$._parent.race[$].ref-target'/>
            <int16_t name='last_caste' refers-to='$$._parent.caste[$].ref-target'/>

            <compound type-name='embark_item_choice' name='item_types'/>

            <stl-vector name='skills' type-name='job_skill'/>
            <stl-vector name='skill_levels' type-name='int32_t' index-refers-to='$$._parent.skills[$]'/>

            <compound name='equipment'> not a compound
                <stl-vector name='skills' type-name='job_skill'/>
                <stl-vector name='skill_levels' type-name='int32_t'
                            index-refers-to='$$._parent.skills[$]'/>

                <stl-vector name='item_types' type-name='item_type'/>
                <stl-vector name='item_subtypes'>
                    <int16_t refers-to='(item-subtype-target $$._parent._parent.item_types[$$._key] $)'/>
                </stl-vector>
                <compound name='item_materials' type-name='material_vec_ref'/>
                <stl-vector name='item_counts' type-name='int32_t'/>
            </compound>

            <stl-vector name='last_item_types' type-name='item_type'/>
            <stl-vector name='last_item_subtypes'>
                <int16_t refers-to='(item-subtype-target $$._parent._parent.item_types[$$._key] $)'/>
            </stl-vector>
            <compound name='last_item_materials' type-name='material_vec_ref'/>
            <stl-vector name='last_item_counts' type-name='int32_t'/>

            <int32_t name='side'/>
            <int32_t name='interaction' refers-to='$$._parent.interactions[$]'/>
            <bool name='tame'/>

            <stl-vector name='interactions' pointer-type='interaction_effect' since='v0.34.01'/>
            <stl-vector name='creature_cnt' type-name='int32_t'
                        index-refers-to='(find-instance $creature_raw $)'/>
            <pointer type-name='unit' name='selecting_mount_un'/>

            <enum name='conflict_level' type-name='conflict_level'/>
            <bitfield name='flag' base-type='uint32_t'> bay12: ARENA_FLAG_*
                <flag-bit name='morale_enable'/>
            </bitfield>
            <uint16_t name='temperature'/>
            <int16_t name='time'/>
            <int32_t name='weather_row'/>
            <int32_t name='weather_selected'/>
            <stl-vector name='tree_types' pointer-type='plant_raw'/>
            <int32_t name='tree_cursor'/>
            <int32_t name='tree_age'/>
            <stl-string name='tree_filter'/>
            <stl-string name='tree_age_str'/>
            <bool name='arena_tree_entering_filter'/>
            <bool name='arena_tree_entering_age'/>
        </compound>

        <compound name='dungeon' since='v0.47.01'> bay12: dungeonst
            <stl-vector name='creature_race' type-name='int16_t' ref-target='creature_raw'/>
            <stl-vector name='creature_caste' type-name='int16_t' ref-target='caste_raw' aux-value='$$._parent.race[$._key]'/>

            <int32_t name='last_selected_creature_index'/>
            <compound type-name='embark_item_choice' name='etl'/>

            <stl-vector name='skill_type' type-name='job_skill'/>
            <stl-vector name='skill_value' type-name='int32_t'
                        index-refers-to='$$._parent.skills[$]'/>

            <stl-vector name='item_types' type-name='item_type'/>
            <stl-vector name='item_subtypes'>
                <int16_t refers-to='(item-subtype-target $$._parent._parent.item_types[$$._key] $)'/>
            </stl-vector>
            <compound name='item_materials' type-name='material_vec_ref'/>
            <stl-vector name='item_amount' type-name='int32_t'/>

            <stl-vector name='race_count' type-name='int32_t'/>
        </compound>

        <compound name='attack_chance_info'> bay12: attack_chance_infost
            <stl-vector name='modifier' pointer-type='attack_chance_modifierst'/>
            <stl-vector name='attack'>
                <pointer> bay12: attack_chance_attackst
                    <pointer name='attack_item' type-name='item'/>
                    <int32_t name='attack_index'/>
                    <bitfield name='modifier_flags' type-name='attack_chance_modifier_flags'/>
                </pointer>
            </stl-vector>
            <stl-vector name='target'>
                <pointer> bay12: attack_chance_targetst
                    <int16_t name='target_bp'/>
                    <int32_t name='initial_hit_chance_adjustment'/>
                    <int32_t name='initial_hit_squareness_adjustment'/>
                    <bitfield name='modifier_flags' type-name='attack_chance_modifier_flags'/>
                </pointer>
            </stl-vector>

            <int32_t name='current_modifier_number'/>
            <int32_t name='current_attack_number'/>
            <int32_t name='current_target_number'/>
        </compound>

        <compound name='active_tutorial'> bay12: active_tutorialst
            <int32_t name='index'/>
            <int32_t name='active_step'/>
        </compound>
    </struct-type>

    <bitfield-type type-name='attack_chance_modifier_flags' base-type='uint32_t'> bay12: ATTACK_CHANCE_MODIFIER_FLAG_*
        <flag-bit name='HEAD'/>
        <flag-bit name='BODY'/>
        <flag-bit name='LIMB'/>
        <flag-bit name='PRIORITY_WIELD'/>
        <flag-bit name='MAIN_ATTACK'/>
        <flag-bit name='ADJUSTED_UP_LOTS'/>
        <flag-bit name='ADJUSTED_UP'/>
        <flag-bit name='ADJUSTED_DOWN'/>
        <flag-bit name='ADJUSTED_DOWN_LOTS'/>
        <flag-bit name='RING_OF_SAVINGS'/>
        <flag-bit name='GRASP'/>
        <flag-bit name='STANCE'/>
        <flag-bit name='ARMOR_3'/>
        <flag-bit name='ARMOR_2'/>
        <flag-bit name='ARMOR_1'/>
        <flag-bit name='SMALL_AIM_MINUS'/>
        <flag-bit name='COUNTS_AS_LETHAL'/>
    </bitfield-type>

    <struct-type type-name='attack_chance_modifierst'>
        <pointer name='attack_item' type-name='item'/>
        <int32_t name='attack_index'/>
        <int16_t name='target_bp'/>
        <int32_t name='hit_chance_adjustment'/>
        <int32_t name='hit_squareness_adjustment'/>
        <bitfield name='flags' type-name='attack_chance_modifier_flags'/>
    </struct-type>

    <enum-type type-name='world_flags'> bay12: WorldFlagType
        <enum-item name='process_columns'/>
        <enum-item name='an_entity_wants_to_mark_news_for_position_claim'/>
        <enum-item name='an_entity_has_possible_evaluate_position_profile'/>
        <enum-item name='an_entity_has_possible_succession_position_profile'/>
        <enum-item name='an_entity_has_possible_appointable_position_profile'/>
        <enum-item name='an_entity_has_possible_elected_position_profile'/>
        <enum-item name='an_entity_has_evaluate_position_profile_activity'/>
        <enum-item name='might_have_realized_site'/>
    </enum-type>

</data-definition>

<!--
Local Variables:
indent-tabs-mode: nil
nxml-child-indent: 4
End:
-->
