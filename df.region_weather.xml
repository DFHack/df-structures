<data-definition>
    <bitfield-type type-name='region_weather_flag' base-type='uint32_t'> bay12: REGION_WEATHER_FLAG_*
        <flag-bit name='announced'/>
    </bitfield-type>

    <enum-type type-name='region_weather_type' base-type='int32_t'> bay12: RegionWeatherType
        <enum-item name='CreepingGas'/>
        <enum-item name='CreepingVapor' comment="doesn't seem to be generated by DF, but appears if hacked"/>
        <enum-item name='CreepingDust'/>
        <enum-item name='FallingMaterial' comment="a.k.a. rain, both blood and syndrome, but not regular"/>
    </enum-type>

    <struct-type type-name='region_weather' key-field='id' instance-vector='$global.world.world_data.region_weather' original-name='region_weatherst' comment="only evil weather, not the regular kind">
        <int32_t name='id'/>
        <enum name='type' type-name='region_weather_type' comment="Creeping Gas/Vapor/Dust='cloud' below, FallingMaterial='rain'"/>
        <int16_t name='mat_type' ref-target='material' aux-value='$$.mat_index'/>
        <int32_t name='mat_index'/>
        <bitfield name='flags' base-type='uint32_t' type-name='region_weather_flag'/>
        <int32_t name='region_x' comment="world tile, used with evil rain. Probably uninitialized with cloud"/>
        <int32_t name='region_y' comment="world tile, used with evil rain. Probably uninitialized with cloud"/>
        <int32_t name='world_in_game_x' init-value='-30000' comment="used with evil clouds, indicating global in-game coordinates"/>
        <int32_t name='world_in_game_y' init-value='-30000' comment="used with evil clouds, indicating global in-game coordinates"/>
        <int32_t name='world_in_game_z' init-value='-30000' comment="probably never used, as weather appears on the surface"/>
        <int32_t name='cloud_x_movement' comment="-1/0/1, indicating the movement per 10 ticks in X direction. Uninitialized for rain"/>
        <int32_t name='cloud_y_movement' comment="-1/0/1, indicating the movement per 10 ticks in Y direction. Uninitialized for rain"/>
        <int32_t name='remaining_duration' comment="ticks down 1 every 10 ticks. Removed some time after reaching 0. Cloud duration seems to start with a fairly large, but somewhat random value"/>
        <int32_t name='region_id' ref-target='world_region' comment="Set for clouds, -1 for rain"/>
    </struct-type>
</data-definition>

<!--
Local Variables:
indent-tabs-mode: nil
nxml-child-indent: 4
End:
-->
