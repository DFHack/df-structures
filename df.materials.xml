<data-definition>
    <enum-type type-name='craft_material_class' comment='not in DF'>
        <enum-attr name='make_skill' type-name='job_skill' default-value='NONE'/>
        <enum-attr name='improve_skill' type-name='job_skill' default-value='NONE'/>

        <enum-item name='None' value='-1'/>

        <enum-item name='Metal'>
            <item-attr name='make_skill' value='FORGE_FURNITURE'/>
            <item-attr name='improve_skill' value='METALCRAFT'/>
        </enum-item>
        <enum-item name='Wood'>
            <item-attr name='make_skill' value='CARPENTRY'/>
            <item-attr name='improve_skill' value='WOODCRAFT'/>
        </enum-item>
        <enum-item name='Gem'>
            <item-attr name='make_skill' value='CUTGEM'/>
            <item-attr name='improve_skill' value='ENCRUSTGEM'/>
        </enum-item>
        <enum-item name='Glass'>
            <item-attr name='make_skill' value='GLASSMAKER'/>
        </enum-item>
        <enum-item name='Stone'>
            <item-attr name='make_skill' value='MASONRY'/>
        </enum-item>

        <enum-item name='Bone'>
            <item-attr name='make_skill' value='BONECARVE'/>
            <item-attr name='improve_skill' value='BONECARVE'/>
        </enum-item>
        <enum-item name='Ivory'>
            <item-attr name='make_skill' value='BONECARVE'/>
            <item-attr name='improve_skill' value='BONECARVE'/>
        </enum-item>
        <enum-item name='Horn'>
            <item-attr name='make_skill' value='BONECARVE'/>
            <item-attr name='improve_skill' value='BONECARVE'/>
        </enum-item>
        <enum-item name='Pearl'>
            <item-attr name='make_skill' value='BONECARVE'/>
            <item-attr name='improve_skill' value='BONECARVE'/>
        </enum-item>
        <enum-item name='Shell'>
            <item-attr name='make_skill' value='BONECARVE'/>
            <item-attr name='improve_skill' value='BONECARVE'/>
        </enum-item>

        <enum-item name='Leather'>
            <item-attr name='make_skill' value='LEATHERWORK'/>
            <item-attr name='improve_skill' value='LEATHERWORK'/>
        </enum-item>
        <enum-item name='Cloth'>
            <item-attr name='make_skill' value='CLOTHESMAKING'/>
            <item-attr name='improve_skill' value='CLOTHESMAKING'/>
        </enum-item>
    </enum-type>

    <struct-type type-name='material_common' comment='not a real structure'>
        <stl-string name='id'/>
        <stl-string name='gem_name1'/>
        <stl-string name='gem_name2'/>
        <stl-string name='stone_name'/>

        <compound name='heat'> not a compound
            <uint16_t name='spec_heat'/>
            <uint16_t name='heatdam_point'/>
            <uint16_t name='colddam_point'/>
            <uint16_t name='ignite_point'/>
            <uint16_t name='melting_point'/>
            <uint16_t name='boiling_point'/>
            <uint16_t name='mat_fixed_temp'/>
        </compound>

        <int32_t name='solid_density'/>
        <int32_t name='liquid_density'/>
        <int32_t name='molar_mass'/>

        <static-array name='state_color' type-name='int32_t'
                      count='6' index-enum='matter_state'/>
        <static-array name='state_name' type-name='stl-string'
                      count='6' index-enum='matter_state'/>
        <static-array name='state_adj' type-name='stl-string'
                      count='6' index-enum='matter_state'/>

        <compound name='strength'> not a compound
            <int32_t name='absorption'/>

            <static-array name='yield' type-name='int32_t'
                          count='6' index-enum='strain_type'/>
            <static-array name='fracture' type-name='int32_t'
                          count='6' index-enum='strain_type'/>
            <static-array name='strain_at_yield' type-name='int32_t'
                          count='6' index-enum='strain_type'/>

            <int32_t name='max_edge'/>
        </compound>

        <int32_t name='material_value'/>

        <df-flagarray name='flags' index-enum='material_flags'/>

        <enum name='extract_storage' type-name='item_type'/>
        <enum name='butcher_special_type' type-name='item_type'/>
        <int16_t name='butcher_special_subtype' refers-to='(item-subtype-target $$._parent.butcher_special_type $)'/>

        <static-array name='meat_name' type-name='stl-string' count='3'/>
        <enum name='meat_organ' type-name='meat_category_type' comment='used for texture selection'/>
        <static-array name='block_name' type-name='stl-string' count='2'/>

        <compound name='reaction_product'> not a compound
            <stl-vector name='id' pointer-type='stl-string'/>
            <stl-vector name='item_type' type-name='item_type'/>
            <stl-vector name='item_subtype' type-name='int16_t'/>
            <compound name='material' type-name='material_vec_ref'/>

            <static-array name='str' count='5'>
                <stl-vector pointer-type='stl-string'/>
            </static-array>
        </compound>

        <compound name='hardens_with_water'> not a compound
            <int16_t name='mat_type' ref-target='material' aux-value='$$.mat_index'/>
            <int32_t name='mat_index'/>

            <static-array name='str' type-name='stl-string' count='3'/>
        </compound>

        <stl-vector name='reaction_class' pointer-type='stl-string'/>
        NOTE: the last field here MUST be one containing pointers,
        otherwise Windows and Linux will end up with different
        alignment/padding between the "base class" and the "subclass".

        In reality, the two structures which "inherit" from this one
        are just two separate structures which happen to have the exact
        same set of fields at the beginning, and we're abusing inheritance
        in order to avoid having to copy/paste everything.
    </struct-type>

    <struct-type type-name='material' original-name='material_definitionst' inherits-from='material_common' custom-methods='true' comment='does not actually inherit'>
        <code-helper name='find-instance'>(material-by-id $ $$)</code-helper>
        <code-helper name='describe'> (describe-material $) </code-helper>

        <uint8_t name='tile'/>

        <static-array name='basic_color' type-name='int16_t' count='2'/>
        <static-array name='build_color' type-name='int16_t' count='3'/>
        <static-array name='tile_color' type-name='int16_t' count='3'/>

        <uint8_t name='item_symbol'/>

        <static-array name='mat_rgb' count='3' type-name='s-float'/>

        <int16_t name='powder_dye'/> // color token index
        <enum type-name='temp_diet_info_type' name='temp_diet_info'/>

        <compound name='syndrome' type-name='creature_interactionst'/>

        <int32_t name='soap_level'/>

        <stl-vector name='sphere' type-name='sphere_type' since='v0.40.01'/>

        <stl-string name='prefix'/>

        <static-array name='food_mat_index' count='39' index-enum='organic_mat_category'>
            <int32_t refers-to='(food-mat-by-idx $$._key $)'
                     comment='When valid, refers to itself.'/>
        </static-array>

        <stl-string name='powder_dye_str' comment='temporary'/>
        <static-array name='state_color_str' type-name='stl-string' count='6' index-enum='matter_state'/>

        <int32_t name='wood_texpos'/>
        <int32_t name='boulder_texpos1'/>
        <int32_t name='boulder_texpos2'/>
        <int32_t name='rough_texpos1'/>
        <int32_t name='rough_texpos2'/>
        <int32_t name='bar_texpos'/>
        <int32_t name='cheese_texpos1'/>
        <int32_t name='cheese_texpos2'/>
        <uint32_t name='texflag'/>

        <custom-methods>
            <cmethod name='isGem'/>
            <cmethod name='isStone'/>
        </custom-methods>
    </struct-type>

    <struct-type type-name='material_vec_ref'>
        <stl-vector name='mat_type'>
            <int16_t ref-target='material' aux-value='$$._parent.mat_index[$._key]'/>
        </stl-vector>
        <stl-vector name='mat_index' type-name='int32_t'/>
    </struct-type>

    <struct-type type-name='material_template' original-name='material_templatest' inherits-from='material_common' comment='does not actually inherit'>
        <code-helper name='describe'> (describe-material $) </code-helper>

        <uint8_t name='tile'/>

        <static-array name='basic_color' type-name='int16_t' count='2'/>
        <static-array name='build_color' type-name='int16_t' count='3'/>
        <static-array name='tile_color' type-name='int16_t' count='3'/>

        <uint8_t name='item_symbol'/>

        <int16_t name='powder_dye'/> // color token index
        <enum type-name='temp_diet_info_type' name='temp_diet_info'/>

        <compound name='syndrome' type-name='creature_interactionst'/>

        <int32_t name='soap_level'/>

        <stl-vector name='sphere' type-name='sphere_type' since='v0.40.01'/>

        <stl-string name='powder_dye_str' comment='temporary'/>
        <static-array name='state_color_str' type-name='stl-string' count='6' index-enum='matter_state'/>
    </struct-type>

    <enum-type type-name='inorganic_flags'> bay12: InorganicFlagType
        <enum-item name='LAVA'/>
        <enum-item name='GENERATED'/>
        <enum-item name='CAN_OCCUR_ON_SURFACE'/>
        <enum-item name='SEDIMENTARY'/>
        <enum-item name='SEDIMENTARY_OCEAN_SHALLOW'/>
        <enum-item name='IGNEOUS_INTRUSIVE'/>
        <enum-item name='IGNEOUS_EXTRUSIVE'/>
        <enum-item name='METAMORPHIC'/>

        <enum-item name='DEEP_SURFACE'/>
        <enum-item name='METAL_ORE'/>
        <enum-item name='AQUIFER'/>
        <enum-item name='SOIL_ANY'/>
        <enum-item name='SOIL_OCEAN'/>
        <enum-item name='SOIL_SAND'/>
        <enum-item name='SEDIMENTARY_OCEAN_DEEP'/>
        <enum-item name='THREAD_METAL'/>

        <enum-item name='SPECIAL' comment='or any DEEP_*'/>
        <enum-item name='SOIL'/>
        <enum-item name='DEEP_SPECIAL'/>
        <enum-item name='DIVINE'/>
        <enum-item name='MYTHICAL'/>
        <enum-item name='MYTHICAL_REMNANT'/>
        <enum-item name='MYTHICAL_SUBSTANCE'/>
        <enum-item/>

        <enum-item/>
        <enum-item name='WAFERS'/>
        <enum-item/>
        <enum-item/>
        <enum-item/>
        <enum-item/>
        <enum-item/>
        <enum-item/>
    </enum-type>

    <struct-type type-name='inorganic_raw' original-name='inorganic_material_definitionst' instance-vector='$global.world.raws.inorganics' custom-methods='true'>
        <stl-string name='id'/>

        <stl-vector name='str' since='v0.34.01' pointer-type='stl-string'/>

        <code-helper name='describe'>$.id</code-helper>

        <df-flagarray name='flags' index-enum='inorganic_flags'/>

        <int32_t name='source_hfid' ref-target='historical_figure'/>
        <int32_t name='source_enid' ref-target='historical_entity' since='v0.42.01'/>

        <compound name='metal_ore'> not a compound
            <stl-vector name='str' comment='only during parsing' pointer-type='stl-string'/>
            <stl-vector name='mat_index'>
                <int16_t ref-target='inorganic_raw'/>
            </stl-vector>
            <stl-vector type-name='int16_t' name='probability'/>
        </compound>

        <compound name='thread_metal'> not a compound
            <stl-vector name='str' comment='only during parsing' pointer-type='stl-string'/>
            <stl-vector name='mat_index'>
                <int16_t ref-target='inorganic_raw'/>
            </stl-vector>
            <stl-vector type-name='int16_t' name='probability'/>
        </compound>

        <stl-vector type-name='int32_t' name='economic_uses' ref-target='reaction'/>

        <compound name='environment_spec'> not a compound
            <stl-vector name='str' comment='only during parsing' pointer-type='stl-string'/>
            <stl-vector name='mat_index'>
                <int16_t ref-target='inorganic_raw'/>
            </stl-vector>
            <stl-vector name='inclusion_type'>
                <enum base-type='int16_t' type-name='inclusion_type'/>
            </stl-vector>
            <stl-vector type-name='int8_t' name='probability'/>
        </compound>

        <compound name='environment'> not a compound
            <stl-vector name='location'>
                <enum base-type='int16_t' type-name='environment_type'/>
            </stl-vector>
            <stl-vector name='type'>
                <enum base-type='int16_t' type-name='inclusion_type'/>
            </stl-vector>
            <stl-vector type-name='int8_t' name='probability'/>
        </compound>

        <int16_t name='times_used_land'/>
        <int16_t name='times_used_ocean'/>

        <compound name='material' type-name='material'/>
        <custom-methods>
            <cmethod name='isOre'/>
        </custom-methods>
    </struct-type>

    <struct-type type-name='special_mat_table' original-name='material_infost'>
        <static-array name='organic_types' count='39' index-enum='organic_mat_category'>
            <stl-vector type-name='int16_t' index-refers-to='(food-mat-by-idx $$._key $)'/>
        </static-array>
        <static-array name='organic_indexes' count='39' index-enum='organic_mat_category'>
            <stl-vector type-name='int32_t'/>
        </static-array>
        <static-array name='organic_temp' count='39' comment='everything 0'
                      index-enum='organic_mat_category'>
            <stl-vector type-name='int32_t'/>
        </static-array>

        <static-array name='builtin' count='659' index-enum='builtin_mats'>
            <pointer type-name='material'/>
        </static-array>

        NOTE: world_raws.syndromes and world_raws.effects should both be directly in here
    </struct-type>
</data-definition>

<!--
Local Variables:
indent-tabs-mode: nil
nxml-child-indent: 4
End:
-->
