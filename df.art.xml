<data-definition>
    <enum-type type-name='poetic_form_action' base-type='int32_t'> bay12: PoeticIntentType
        <enum-item name='None' value='-1'/>
        <enum-item name='Describe'/>
        <enum-item name='Satirize'/>
        <enum-item name='AmuseAudience'/>
        <enum-item name='Complain'/>
        <enum-item name='Renounce'/>
        <enum-item name='MakeApology'/>
        <enum-item name='ExpressPleasure'/>
        <enum-item name='ExpressGrief'/>
        <enum-item name='Praise'/>
        <enum-item name='TeachMoralLesson'/>
        <enum-item name='MakeAssertion'/>
        <enum-item name='MakeCounterAssertion'/>
        <enum-item name='MakeConsession'/>
        <enum-item name='SynthesizePreviousIdeas'/>
        <enum-item name='DevelopPreviousIdea'/>
        <enum-item name='InvertTheAssertion'/>
        <enum-item name='UndercutAssertion'/>
        <enum-item name='MoveAwayFromPreviousIdeas'/>
        <enum-item name='ReflectPreviousIdeas'/>
        <enum-item name='ConsoleAudience'/>
        <enum-item name='RefuseConsolation'/>
        <enum-item name='OfferDifferentPerspective'/>
        <enum-item name='Beseech' since='v0.47.01'/>
    </enum-type>

    A - even, B - uneven for tone patterns, A - unstressed, B - stressed for accent patterns
    <enum-type type-name='poetic_form_pattern' base-type='int32_t'> bay12: PoeticStressType
        <enum-item name='None' value='-1'/>
        <enum-item name='AA' comment='Pyrrhic'/>
        <enum-item name='AB' comment='Iambic'/>
        <enum-item name='BA' comment='Trochaic'/>
        <enum-item name='BB' comment='Spondaic'/>
        <enum-item name='AAA' comment='Tribrachic'/>
        <enum-item name='BAA' comment='Dactylic'/>
        <enum-item name='ABA' comment='Amphibrachic'/>
        <enum-item name='AAB' comment='Anapestic'/>
        <enum-item name='ABB' comment='Bacchic'/>
        <enum-item name='BBA' comment='Antibacchic'/>
        <enum-item name='BAB' comment='Cretic'/>
        <enum-item name='BBB' comment='Molossic'/>
    </enum-type>

    <enum-type type-name='poetic_form_caesura_position' base-type='int32_t'> bay12: PoeticCaesuraType
        <enum-item name='None' value='-1'/>
        <enum-item name='Initial'/>
        <enum-item name='Medial'/>
        <enum-item name='Terminal'/>
    </enum-type>

    <enum-type type-name='poetic_form_mood' base-type='int32_t'> bay12: PoeticStyleType
        <enum-item name='None' value='-1'/>
        <enum-item name='Narrative'/>
        <enum-item name='Dramatic'/>
        <enum-item name='Reflective'/>
        <enum-item name='Riddle'/>
        <enum-item name='Ribald'/>
        <enum-item name='Light'/>
        <enum-item name='Solemn'/>
    </enum-type>

    <enum-type type-name='poetic_form_subject' base-type='int32_t'> bay12: PoeticSubjectType
        <enum-item name='None' value='-1'/> "a chosen subject"
        <enum-item name='Past'/>
        <enum-item name='CurrentEvents' comment='Present'/>
        <enum-item name='Future'/>
        <enum-item name='SomeoneRecentlyDeceased'/>
        <enum-item name='SomeoneRecentlyRetired'/>
        <enum-item name='Religion'/>
        <enum-item name='SpecificPlace' comment='Site'/>
        <enum-item name='SpecificWildernessRegion' comment='Subregion'/>
        <enum-item name='Nature'/>
        <enum-item name='Lover'/>
        <enum-item name='Family'/>
        <enum-item name='AlcoholicBeverages' comment='Booze'/>
        <enum-item name='Journey' comment='Travels'/>
        <enum-item name='War'/>
        <enum-item name='Hunt'/>
        <enum-item name='Mining'/>
        <enum-item name='Death'/>
        <enum-item name='Immortality'/>
        <enum-item name='SomeonesCharacter'/>
        <enum-item name='Histfig'/> "a historical figure" or a specific figure
        <enum-item name='Concept' comment='Sphere'/> "an abstract concept" or a specific concept
    </enum-type>

    <struct-type type-name='poetic_form_subject_target' is-union='true'>
        <compound name='Histfig'>
            <int32_t name='subject_histfig' ref-target='historical_figure'/>
        </compound>
        <compound name='Concept'>
            <enum name='subject_topic' base-type='int32_t' type-name='sphere_type'/>
        </compound>
    </struct-type>

    <bitfield-type type-name="poetic_form_feature" base-type="uint32_t"> bay12: POETIC_FORM_LINE_FLAG_*
        <flag-bit name="InternalRhyme"/>
        <flag-bit name="EndRhymesDontMatch" comment='SoftEndRhyme'/>
        <flag-bit name="Alliteration"/>
        <flag-bit name="Onomatopoeia"/>
        <flag-bit name="Antanaclasis"/>
        <flag-bit name="DifferentReadings"/> "different readings depending on word breaks"
        <flag-bit name="ReadBackwards"/> "can be read backwards as well as forwards"
        <flag-bit name="ReadOrthogonally"/> "can be read orthogonally across the standard lines"
        <flag-bit name="Emerge" comment='ReadPathwise'/> "emerge when reading along certain prescribed paths across the body of the poem"
        <flag-bit name="Assonance"/>
        <flag-bit name="Consonance"/>
        <flag-bit name="Elision"/>
        <flag-bit name="Epenthesis"/>
        <flag-bit name="Synchysis"/>
        <flag-bit name="QuantitativeMeter"/>
        <flag-bit name="Allegory"/>
        <flag-bit name="Ambiguity"/>
        <flag-bit name="Symbolism"/>
        <flag-bit name="Metaphor"/>
        <flag-bit name="Simile"/>
        <flag-bit name="Metonymy"/>
        <flag-bit name="VividImagery"/>
        <flag-bit name="Juxtaposision"/>
    </bitfield-type>

    <enum-type type-name='poetic_form_additional_feature' base-type='int32_t'> bay12: PoeticParallelismType
        <enum-item name='SharesUnderlyingMeaning'/>
        <enum-item name='ContrastsUnderlyingMeaning'/>
        <enum-item name='RequiredToMaintainPhrasing'/>
        <enum-item name='SameGrammaticalStructure'/>
        <enum-item name='SamePlacementOfAllusions'/>
        <enum-item name='ReverseWordOrder'/>
        <enum-item name='ReverseGrammaticalStructure'/>
        <enum-item name='PresentsDifferentView'/>
        <enum-item name='MustExpandIdea'/>
    </enum-type>

    <struct-type type-name='poetic_form' original-name='poetic_formst' instance-vector='$global.world.poetic_forms.all' key-field='id'>
        <int32_t name='id'/>
        <compound name='name' type-name='language_name'/>
        <int32_t name='originating_entity' ref-target='historical_entity'/> "originating in ..."
        <int32_t name='original_author' ref-target='historical_figure'/> "originally devised by ..."
        <int32_t name='subject_hf' ref-target='historical_figure' comment='worship target'/>

        <bitfield base-type='uint32_t' name='flags'>
            <flag-bit name='tone_patterns' comment='tonal_replaces_stress'/>
            <flag-bit name='produces_individual_poems' comment='has_compositions'/>
        </bitfield>

        <stl-vector name='parts' pointer-type='poetic_form_part'/>
        <int32_t name='each_line_feet' comment='meter'/>
        <enum name='each_line_pattern' base-type='int32_t' type-name='poetic_form_pattern'/>

        <enum name='every_line_caesura_position' base-type='int32_t' type-name='poetic_form_caesura_position'/>

        "certain lines often ... and they sometimes ..."
        <stl-vector name='common_features'>
            <enum base-type='int32_t' type-name='poetic_form_additional_feature'/>
        </stl-vector>

        "is a narrative/... poetic form"
        <enum name='mood' base-type='int32_t' type-name='poetic_form_mood'/>
        <enum name='subject' base-type='int32_t' type-name='poetic_form_subject'/>
        <compound name='subject_target' type-name='poetic_form_subject_target'/>

        <enum name='action' base-type='int32_t' type-name='poetic_form_action'/>

        <int32_t name='preferred_perspective' comment='if not -1, ALWAYS written from that perspective'/>

        "use of ... is characteristic of the form" or "must feature lines which ..."
        <bitfield name='features' type-name='poetic_form_feature'/>

        <stl-vector name='perspectives' pointer-type='poetic_form_perspective'/>
    </struct-type>

    <struct-type type-name='poetic_form_part' original-name='poetic_form_sectionst'>
        <bitfield base-type='uint32_t' name='flags'>
            <flag-bit name='end_rhyme_global_pattern'/> "line, couplet, tercet" if set, "brief verse paragraphs"/"full verse paragraphs" otherwise
            <flag-bit name='verse_paragraph'/>
            <flag-bit name='end_rhyme_shared_in_stanzas'/>
        </bitfield>

        "has X to Y couplets/..."
        <int32_t name='count_min'/>
        <int32_t name='count_max'/>

        size_in_lines is set: line, couplet, tercet, quatrain, quintain, etc.
        size_in_lines is not set: "brief verse" if less than 6, otherwise "full verse"
        <int32_t name='size'/>

        <static-array name='refrain_line' count='2' type-name='int32_t'/>
        <static-array name='refrain_id' count='2' type-name='int32_t'/>

        <stl-vector name='line_endings' type-name='int32_t'/>
        <stl-vector name='line_feet' type-name='int32_t'/> "the Nth line has XX feet"
        <stl-vector name='line_patterns'>
            <enum base-type='int32_t' type-name='poetic_form_pattern'/>
        </stl-vector>

        <stl-vector name='line_caesura_positions'>
            <enum base-type='int32_t' type-name='poetic_form_caesura_position'/>
        </stl-vector>

        "first line must make use of ..."
        <stl-vector name='line_features'>
            <bitfield type-name='poetic_form_feature'/>
        </stl-vector>

        "The XX line ZZ of ... on YY line"
        <stl-vector name='additional_features'> ZZ
            <enum base-type='int32_t' type-name='poetic_form_additional_feature'/>
        </stl-vector>
        <stl-vector name='additional_targets' type-name='int32_t'/> YY
        <stl-vector name='additional_lines' type-name='int32_t'/> XX

        <stl-vector name='line_mood'>
            <enum base-type='int32_t' type-name='poetic_form_mood'/>
        </stl-vector>
        <stl-vector name='line_subject'>
            <enum base-type='int32_t' type-name='poetic_form_subject'/>
        </stl-vector>
        <stl-vector name='line_subject_target' type-name='poetic_form_subject_target'/>
        <stl-vector name='line_action'>
            <enum base-type='int32_t' type-name='poetic_form_action'/>
        </stl-vector>
        <stl-vector name='line_persona_ind' type-name='int32_t'/>

        <int32_t name='some_lines_syllables'/> "it has lines with ... syllables"
        <enum name='some_lines_pattern' type-name='poetic_form_pattern'/> "it has lines with a tone/accent pattern of ..."

        "it has ... caesura in each line"
        <enum name='each_line_caesura_position' base-type='int32_t' type-name='poetic_form_caesura_position'/>

        "certain lines have ..." same as additional_features above
        <stl-vector name='certain_lines_additional_features'>
            <enum base-type='int32_t' type-name='poetic_form_additional_feature'/>
        </stl-vector>

        <enum name='mood' base-type='int32_t' type-name='poetic_form_mood'/>
        <enum name='subject' base-type='int32_t' type-name='poetic_form_subject'/>
        <int32_t name='subject_id'/>
        <enum name='action' base-type='int32_t' type-name='poetic_form_action'/>
        <int32_t name='persona_id'/>
        <bitfield base-type='uint32_t' name='line_flags' type-name='poetic_form_feature'/>
    </struct-type>

    <struct-type type-name='poetic_form_perspective' original-name='poetic_form_personast'>
        "written from the perspective of ..."
        <enum name='type' base-type='int32_t'> bay12: PoeticFormPersonaType
            <enum-item name='Author'/>
            <enum-item name='Soldier'/>
            <enum-item name='Traveller'/>
            <enum-item name='RelativeOfAuthor'/>
            <enum-item name='PartyOfDebate'/>
            <enum-item name='FictionalPoet'/>
            <enum-item name='Histfig'/>
            <enum-item name='Animal'/>
        </enum>
        <int32_t name='subtype' comment='Histfig:ID, Animal:Race'/>
        <int32_t name='subtype2' comment='Animal:Caste'/>
    </struct-type>

    <enum-type type-name='scale_type' base-type='int32_t'> bay12: ScaleFoundationType
        <enum-item name='Octave' comment="The octave is divided into X steps of even length"/>
        <enum-item name='Variable' comment="The octave is divided into notes at varying intervals, approximated by quartertones"/>
        <enum-item name='PerfectFourth' comment="The perfect fourth interval is divided into steps of even length"/>
    </enum-type>

    <struct-type type-name='chord' original-name='scale_chordst'>
        <stl-string name='name'/>
        <static-array name='notes' type-name='int32_t' count='5' comment="chord_size entries used. Refers to the notes indices"/>
        <int32_t name='chord_size'/>
        <bitfield base-type='uint32_t' name='flags'> bay12: SCALE_CHORD_FLAG_*
            <flag-bit comment='lower'/>
        </bitfield>
    </struct-type>

    <enum-type type-name='scale_construction_type' base-type='int32_t'> bay12: ScaleConstructionType
        <enum-item name='ByInterval'/>
        <enum-item name='PerfectFifthJoinedPerfectFourth'/>
        <enum-item name='PerfectFifthHalfMajorThird'/>
        <enum-item name='TritoneHalfPercentFourth'/>
        <enum-item name='PerfectFourthWholePerfectFourth'/>
    </enum-type>

    <struct-type type-name='named_scale' original-name='scale_constructionst'>
        <enum name='type' type-name='scale_construction_type'/>
        <stl-string name='name'/>
        <static-array name='degrees' type-name='int32_t' count='7' comment="indices into the (not necessarily named) notes of the scale"/>
        <int32_t name='degrees_used' comment="elements used in array above"/>
        <static-array name='chord_index' type-name='int32_t' count='2'/>
    </struct-type>

    <enum-type type-name='scale_naming_type' base-type='int32_t'> bay12: ScaleNamingType
        <enum-item name='EveryNote'/>
        <enum-item name='PreferredNotes'/>
        <enum-item name='EveryNoteAfterConstructionByDegree'/>
        <enum-item name='PreferredNoteAfterConstructionByDegree'/>
    </enum-type>

    <struct-type type-name='scale_namingst'>
        <enum name='type' type-name='scale_naming_type'/>
        <static-array name='name' type-name='stl-string' count='25'/>
        <static-array name='abreviation' type-name='stl-string' count='25'/>
        <static-array name='number' type-name='int32_t' count='25'/>
        <int32_t name='length' comment='number of elements of the arrays above used'/>
    </struct-type>

    <struct-type type-name='scale' instance-vector='$global.world.scales.all' key-field='id'>
        <int32_t name='id'/>
        <bitfield name='flags' base-type='uint32_t'> bay12: SCALE_FLAG_*
            <flag-bit name='tonic_note_fixed_at_performance' comment='moveable_tonic'/>
        </bitfield>
        <enum name='type' type-name='scale_type' base-type='int32_t'/>
        <static-array name='quartertones_used' type-name='int32_t' count='25' comment="Quartertone corresponding note matches. Scale_length elements are used when type = Variable. Unused elements uninitialized"/>
        <int32_t name='scale_length' comment="Number of notes in the scale. When type = Variable this is the number of used indices pointing out their placement."/>
        <stl-vector name='chords' pointer-type='chord'/>
        <stl-vector name='scales' pointer-type='named_scale' comment="Note that the top level scale doesn't have a name. These seem to be named scales using the unnamed scale's notes as their foundation"/>
        <compound name='notes' type-name='scale_namingst'/>
    </struct-type>

    <struct-type type-name='rhythm' instance-vector='$global.world.rhythms.all' key-field='id'>
        <int32_t name='id'/>
        <stl-vector name='patterns' pointer-type='rhythm_pattern'/>
        <stl-vector name='sub_rhythms' pointer-type='sub_rhythm'/>
        <bitfield name='flags' base-type='uint32_t'> bay12: RHYTHM_FLAG_*
            <flag-bit name='fundamental_polyrhythm'/>
            <flag-bit name='fundamental_polymeter'/>
        </bitfield>
    </struct-type>

    <bitfield-type type-name='beat_flag' base-type='uint32_t'> bay12: RHYTHM_BEAT_FLAG_*
        <flag-bit name='PrimaryAccent'/>
        <flag-bit name='Accent'/>
        <flag-bit name='Regular'/>
        <flag-bit name='Early'/>
        <flag-bit name='Late'/>
    </bitfield-type>

    <struct-type type-name='rhythm_barst'>
        <pointer name='beat' is-array='true' type-name='beat_flag' comment="Length as per length field"/>
        <int32_t name='length'/>
    </struct-type>

    <struct-type type-name='rhythm_pattern' original-name='rhythm_patternst'>
        <stl-string name='name'/>
        <stl-vector name='bars' pointer-type='rhythm_barst'/>
        <pointer name='beat_name' type-name='stl-string' is-array='true' comment="length as per length field"/>
        <pointer name='beat_abbreviation' type-name='stl-string' is-array='true' comment="length as per length field"/>
        <int32_t name='length'/>
    </struct-type>

    <bitfield-type type-name='rhythm_construction_pattern_flag' base-type='uint32_t'> bay12: RHYTHM_CONSTRUCTION_PATTERN_FLAG_*
        <flag-bit name='Primary'/>
        <flag-bit name='Secondary'/>
    </bitfield-type>

    <struct-type type-name='sub_rhythm' original-name='rhythm_constructionst'>
        <stl-string name='name'/>
        <stl-vector name='patterns' type-name='int32_t' comment="indices into patterns"/>
        <stl-vector name='pattern_flags' type-name='rhythm_construction_pattern_flag' comment="Same length as patterns"/>
        <bitfield name='flags' base-type='uint32_t'> bay12: RHYTHM_CONSTRUCTION_FLAG_*
            <flag-bit name='polymetric'/>
        </bitfield>
    </struct-type>

    <struct-type type-name='occupation' instance-vector='$global.world.occupations.all' key-field='id' original-name='occupationst'>
        <int32_t name='id'/>
        <enum name='type' base-type='int32_t' type-name='occupation_type'/>
        <int32_t name='histfig_id' ref-target='historical_figure'/>
        <int32_t name='unit_id' ref-target='unit'/>
        <int32_t name='location_id' ref-target='abstract_building' aux-value='$$.site_id'/>
        <int32_t name='site_id' ref-target='world_site'/>
        <int32_t name='group_id' ref-target='historical_entity'/>
        <stl-vector name='service_order' pointer-type='service_orderst' comment='local id vector'/>
        <int32_t name='next_service_order_id'/>

        <pointer name='wg_site' type-name='world_site' has-bad-pointers='true' comment='worldgen only'/>
        <pointer name='wg_ab' type-name='abstract_building' has-bad-pointers='true' comment='worldgen only'/>
    </struct-type>

    <enum-type type-name='service_order_type' base-type='int32_t'> bay12: ServiceOrderType
        <enum-item name='NONE' value='-1'/>
        <enum-item name='DRINK'/>
        <enum-item name='ROOM_RENTAL'/>
        <enum-item name='EXTEND_ROOM_RENTAL'/>
    </enum-type>

    <struct-type type-name='service_orderst'>
        <int32_t name='local_id'/>
        <enum base-type='int32_t' name="type" type-name='service_order_type'/>
        <enum name='item_type' type-name='item_type'/>
        <int16_t name='item_subtype'/>
        <int16_t name='mat_type'/>
        <int32_t name='mat_index'/>
        <int32_t name='customer_hfid'/>
        <int32_t name='customer_unid'/>
        <int32_t name='money_owed'/>
        <int32_t name='room_ab_local_id' comment='not zone or ab id -- something local to ab'/>
        <int32_t name='start_year'/>
        <int32_t name='start_season_count'/>
        <int32_t name='end_year'/>
        <int32_t name='end_season_count'/>
        <int32_t name='last_failed_year'/>
        <int32_t name='last_failed_season_count'/>
        <int32_t name='activity_id'/>
        <int32_t name='activity_event_id'/>
        <bitfield name='flag'>
            <flag-bit name='completed'/>
        </bitfield>
    </struct-type>

</data-definition>

<!--
Local Variables:
indent-tabs-mode: nil
nxml-child-indent: 4
End:
-->
